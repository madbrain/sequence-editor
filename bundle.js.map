{"version":3,"sources":["webpack://Editor/webpack/universalModuleDefinition","webpack://Editor/webpack/bootstrap","webpack://Editor/./src/model.ts","webpack://Editor/./src/geometry.ts","webpack://Editor/./src/states.ts","webpack://Editor/./src/command.ts","webpack://Editor/./src/renderer.ts","webpack://Editor/./node_modules/svelte/internal/index.mjs","webpack://Editor/./src/Editor.svelte","webpack://Editor/./src/index.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","createMessage","createLifeLine","createModel","MoveLifeLineCommand","MoveMessageCommand","AddMessageCommand","AddLifeLineCommand","SetMessageToCommand","SetMessageFromCommand","message","end","this","oldEnd","from","execute","undo","redo","to","model","lifeLine","lifeLines","push","pop","messages","position","oldPosition","indexOf","splice","id","randomText","choice","e","list","x","choiceNot","text","size","pieces","result","length","Math","floor","random","Array","fill","map","Rectangle","Point","y","centeredRect","width","height","rect","distance","other","dx","dy","sqrt","contains","corner","expand","amount","center","DragLifeLine","StartDragLifeLine","DragMessage","StartDragMessage","DragHandle","StartDragHandle","IdleState","DiagramContext","commandStack","renderer","refreshCallback","refresh","doRender","view","render","context","mouseDown","event","handle","findMessageHandle","findMessage","findLifeLine","console","log","mouseUp","select","mouseMove","testHover","startDrag","dragPoint","startPendingMessage","finishPendingMessage","updatePendingMessage","startDragMessage","finishDragMessage","updateDragMessage","startDragLifeLine","finishDragLifeLine","updateDragLifeLine","CommandStack","stack","current","command","canUndo","canRedo","Renderer","MessageHandle","MessageView","LifelineView","PendingLifeLineView","PendingDragMessageView","PendingMessageView","DiagramView","geometry_1","model_1","style","messageStart","pendingMessage","pendingDragMessage","pendingLifeLine","changed","forEach","_this","setPosition","hoverOther","lifeline","abs","centerX","setHover","finish","update","_i","_a","bounds","find","markerBounds","hoverBounds","layout","max","headHeight","layoutMessages","leftMargin","topMargin","lineHeight","messageWidth","messageMargin","index","diff","prev","minDiff","minHeadGap","diagram","messageStartGap","messageGap","selected","pos","otherHandle","editing","hover","offset","sign","newPosition","snap","mid","options","textSize","ascent","mousePoint","reversed","min","measurer","createLifeline","lifeLineMap","metrics","measure","lifeLineHeadTextSize","actualBoundingBoxAscent","actualBoundingBoxDescent","lifeLineHeadMargin","minHeadHeight","messageTextSize","noop","run","fn","blank_object","run_all","fns","is_function","thing","safe_not_equal","a","b","is_empty","obj","keys","Set","append","target","node","appendChild","insert","anchor","insertBefore","detach","parentNode","removeChild","destroy_each","iterations","detaching","document","createElement","svg_element","createElementNS","data","createTextNode","space","empty","listen","handler","addEventListener","removeEventListener","attr","attribute","removeAttribute","getAttribute","setAttribute","set_data","wholeText","crossorigin","is_crossorigin","undefined","parent","error","toggle_class","element","toggle","classList","current_component","set_current_component","component","get_current_component","Error","dirty_components","binding_callbacks","render_callbacks","flush_callbacks","resolved_promise","Promise","resolve","update_scheduled","schedule_update","then","flush","add_render_callback","flushing","seen_callbacks","$$","callback","has","add","clear","fragment","before_update","dirty","ctx","after_update","outroing","outros","transition_in","block","local","delete","transition_out","globalThis","global","SvelteElement","mount_component","customElement","on_mount","on_destroy","new_on_destroy","filter","destroy_component","init","instance","create_fragment","not_equal","props","parent_component","bound","on_disconnect","Map","callbacks","skip_bound","ready","ret","rest","make_dirty","hydrate","nodes","childNodes","intro","HTMLElement","super","attachShadow","slotted","_oldValue","newValue","$destroy","type","$$props","$$set","SvelteComponent","getComputedStyle","iframe","tabIndex","unsubscribe","src","source","contentWindow","onload","state","diagramContext","paletteState","measureText","font","canvas","getContext","v","clientX","clientY","body"],"mappings":"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","file":"bundle.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Editor\"] = factory();\n\telse\n\t\troot[\"Editor\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n","\"use strict\";\nexports.__esModule = true;\nexports.createMessage = exports.createLifeLine = exports.createModel = exports.MoveLifeLineCommand = exports.MoveMessageCommand = exports.AddMessageCommand = exports.AddLifeLineCommand = exports.SetMessageToCommand = exports.SetMessageFromCommand = void 0;\nvar SetMessageFromCommand = /** @class */ (function () {\n    function SetMessageFromCommand(message, end) {\n        this.message = message;\n        this.end = end;\n        this.oldEnd = this.message.from;\n    }\n    SetMessageFromCommand.prototype.execute = function () {\n        this.message.from = this.end;\n    };\n    SetMessageFromCommand.prototype.undo = function () {\n        this.message.from = this.oldEnd;\n    };\n    SetMessageFromCommand.prototype.redo = function () {\n        this.execute();\n    };\n    return SetMessageFromCommand;\n}());\nexports.SetMessageFromCommand = SetMessageFromCommand;\nvar SetMessageToCommand = /** @class */ (function () {\n    function SetMessageToCommand(message, end) {\n        this.message = message;\n        this.end = end;\n        this.oldEnd = this.message.to;\n    }\n    SetMessageToCommand.prototype.execute = function () {\n        this.message.to = this.end;\n    };\n    SetMessageToCommand.prototype.undo = function () {\n        this.message.to = this.oldEnd;\n    };\n    SetMessageToCommand.prototype.redo = function () {\n        this.execute();\n    };\n    return SetMessageToCommand;\n}());\nexports.SetMessageToCommand = SetMessageToCommand;\nvar AddLifeLineCommand = /** @class */ (function () {\n    function AddLifeLineCommand(model, lifeLine) {\n        this.model = model;\n        this.lifeLine = lifeLine;\n    }\n    AddLifeLineCommand.prototype.execute = function () {\n        this.model.lifeLines.push(this.lifeLine);\n    };\n    AddLifeLineCommand.prototype.undo = function () {\n        this.model.lifeLines.pop();\n    };\n    AddLifeLineCommand.prototype.redo = function () {\n        this.execute();\n    };\n    return AddLifeLineCommand;\n}());\nexports.AddLifeLineCommand = AddLifeLineCommand;\nvar AddMessageCommand = /** @class */ (function () {\n    function AddMessageCommand(model, message) {\n        this.model = model;\n        this.message = message;\n    }\n    AddMessageCommand.prototype.execute = function () {\n        this.model.messages.push(this.message);\n    };\n    AddMessageCommand.prototype.undo = function () {\n        this.model.messages.pop();\n    };\n    AddMessageCommand.prototype.redo = function () {\n        this.execute();\n    };\n    return AddMessageCommand;\n}());\nexports.AddMessageCommand = AddMessageCommand;\nvar MoveMessageCommand = /** @class */ (function () {\n    function MoveMessageCommand(model, message, position) {\n        this.model = model;\n        this.message = message;\n        this.position = position;\n        this.oldPosition = this.model.messages.indexOf(message);\n    }\n    MoveMessageCommand.prototype.execute = function () {\n        this.model.messages.splice(this.oldPosition, 1);\n        this.model.messages.splice(this.position, 0, this.message);\n    };\n    MoveMessageCommand.prototype.undo = function () {\n        this.model.messages.splice(this.position, 1);\n        this.model.messages.splice(this.oldPosition, 0, this.message);\n    };\n    MoveMessageCommand.prototype.redo = function () {\n        this.execute();\n    };\n    return MoveMessageCommand;\n}());\nexports.MoveMessageCommand = MoveMessageCommand;\nvar MoveLifeLineCommand = /** @class */ (function () {\n    function MoveLifeLineCommand(model, lifeLine, position) {\n        this.model = model;\n        this.lifeLine = lifeLine;\n        this.position = position;\n        this.oldPosition = this.model.lifeLines.indexOf(lifeLine);\n    }\n    MoveLifeLineCommand.prototype.execute = function () {\n        this.model.lifeLines.splice(this.oldPosition, 1);\n        this.model.lifeLines.splice(this.position, 0, this.lifeLine);\n    };\n    MoveLifeLineCommand.prototype.undo = function () {\n        this.model.lifeLines.splice(this.position, 1);\n        this.model.lifeLines.splice(this.oldPosition, 0, this.lifeLine);\n    };\n    MoveLifeLineCommand.prototype.redo = function () {\n        this.execute();\n    };\n    return MoveLifeLineCommand;\n}());\nexports.MoveLifeLineCommand = MoveLifeLineCommand;\nvar id = 0;\nfunction createModel() {\n    var lifeLines = new Array(5).fill(0).map(function (x) { return createLifeLine(); });\n    var messages = new Array(7).fill(0).map(function (x) { return createMessage(lifeLines); });\n    return {\n        lifeLines: lifeLines,\n        messages: messages\n    };\n}\nexports.createModel = createModel;\nfunction createLifeLine() {\n    return {\n        id: \"L\" + id++,\n        name: randomText(4)\n    };\n}\nexports.createLifeLine = createLifeLine;\nfunction createMessage(lifeLines) {\n    var from = choice(lifeLines);\n    var to = choiceNot(from, lifeLines);\n    return {\n        id: \"M\" + id++,\n        from: from,\n        to: to,\n        text: randomText()\n    };\n}\nexports.createMessage = createMessage;\nfunction randomText(size) {\n    if (size === void 0) { size = 10; }\n    var pieces = [\"mo\", \"bi\", \"sha\", \"doo\", \"fli\", \"re\", \"po\", \"gra\"];\n    var result = \"\";\n    var length = 2 + Math.floor(Math.random() * size);\n    for (var i = 0; i < length; ++i) {\n        result += choice(pieces);\n    }\n    return result;\n}\nfunction choiceNot(e, list) {\n    while (true) {\n        var x = choice(list);\n        if (x != e) {\n            return x;\n        }\n    }\n}\nfunction choice(list) {\n    return list[Math.floor(Math.random() * list.length)];\n}\n","\"use strict\";\nexports.__esModule = true;\nexports.Rectangle = exports.Point = void 0;\nvar Point = /** @class */ (function () {\n    function Point(x, y) {\n        this.x = x;\n        this.y = y;\n    }\n    Point.prototype.centeredRect = function (width, height) {\n        return new Rectangle(this.x - width / 2, this.y - height / 2, width, height);\n    };\n    Point.prototype.rect = function (width, height) {\n        return new Rectangle(this.x, this.y, width, height);\n    };\n    Point.prototype.distance = function (other) {\n        var dx = this.x - other.x;\n        var dy = this.y - other.y;\n        return Math.sqrt(dx * dx + dy * dy);\n    };\n    return Point;\n}());\nexports.Point = Point;\nvar Rectangle = /** @class */ (function () {\n    function Rectangle(x, y, width, height) {\n        this.x = x;\n        this.y = y;\n        this.width = width;\n        this.height = height;\n    }\n    Rectangle.prototype.contains = function (p) {\n        return this.x <= p.x && p.x < this.corner().x && this.y <= p.y && p.y < this.corner().y;\n    };\n    Rectangle.prototype.corner = function () {\n        return new Point(this.x + this.width, this.y + this.height);\n    };\n    Rectangle.prototype.expand = function (amount) {\n        return new Rectangle(this.x - amount, this.y - amount, this.width + amount * 2, this.height + amount * 2);\n    };\n    Rectangle.prototype.center = function () {\n        return new Point(this.x + this.width / 2, this.y + this.height / 2);\n    };\n    return Rectangle;\n}());\nexports.Rectangle = Rectangle;\n","\"use strict\";\nexports.__esModule = true;\nexports.DragLifeLine = exports.StartDragLifeLine = exports.DragMessage = exports.StartDragMessage = exports.DragHandle = exports.StartDragHandle = exports.IdleState = exports.DiagramContext = void 0;\nvar DiagramContext = /** @class */ (function () {\n    function DiagramContext(commandStack, model, renderer, refreshCallback) {\n        this.commandStack = commandStack;\n        this.model = model;\n        this.renderer = renderer;\n        this.refreshCallback = refreshCallback;\n    }\n    DiagramContext.prototype.refresh = function (doRender) {\n        if (doRender) {\n            this.view = this.renderer.render(this.model);\n        }\n        this.refreshCallback(this.view);\n    };\n    return DiagramContext;\n}());\nexports.DiagramContext = DiagramContext;\nvar IdleState = /** @class */ (function () {\n    function IdleState(context) {\n        this.context = context;\n    }\n    IdleState.prototype.mouseDown = function (event) {\n        var handle = this.context.view.findMessageHandle(event);\n        if (handle) {\n            return new StartDragHandle(this.context, event, handle);\n        }\n        var message = this.context.view.findMessage(event);\n        if (message) {\n            return new StartDragMessage(this.context, event, message);\n        }\n        var lifeLine = this.context.view.findLifeLine(event);\n        if (lifeLine) {\n            return new StartDragLifeLine(this.context, event, lifeLine);\n        }\n        console.log(\"IDLE DOWN\", event);\n        return this;\n    };\n    IdleState.prototype.mouseUp = function (event) {\n        this.context.view.select(null);\n        this.context.refresh(false);\n        console.log(\"IDLE UP\", event);\n        return this;\n    };\n    IdleState.prototype.mouseMove = function (event) {\n        if (this.context.view.testHover(event)) {\n            this.context.refresh(false);\n        }\n        return this;\n    };\n    return IdleState;\n}());\nexports.IdleState = IdleState;\nvar StartDragHandle = /** @class */ (function () {\n    function StartDragHandle(context, startDrag, handle) {\n        this.context = context;\n        this.startDrag = startDrag;\n        this.handle = handle;\n    }\n    StartDragHandle.prototype.mouseDown = function (event) {\n        return this;\n    };\n    StartDragHandle.prototype.mouseUp = function (event) {\n        return new IdleState(this.context);\n    };\n    StartDragHandle.prototype.mouseMove = function (event) {\n        if (event.distance(this.startDrag) > 10) {\n            return new DragHandle(this.context, event, this.handle);\n        }\n        return this;\n    };\n    return StartDragHandle;\n}());\nexports.StartDragHandle = StartDragHandle;\nvar DragHandle = /** @class */ (function () {\n    function DragHandle(context, dragPoint, handle) {\n        this.context = context;\n        this.dragPoint = dragPoint;\n        this.handle = handle;\n        this.context.view.startPendingMessage(handle, dragPoint.x);\n        this.context.refresh(false);\n    }\n    DragHandle.prototype.mouseDown = function (event) {\n        return this;\n    };\n    DragHandle.prototype.mouseUp = function (event) {\n        this.context.view.finishPendingMessage(this.context.commandStack);\n        this.context.refresh(true); // TODO test command stack if need to refresh\n        return new IdleState(this.context);\n    };\n    DragHandle.prototype.mouseMove = function (event) {\n        this.context.view.updatePendingMessage(event.x);\n        this.context.refresh(false);\n        return this;\n    };\n    return DragHandle;\n}());\nexports.DragHandle = DragHandle;\nvar StartDragMessage = /** @class */ (function () {\n    function StartDragMessage(context, startDrag, message) {\n        this.context = context;\n        this.startDrag = startDrag;\n        this.message = message;\n    }\n    StartDragMessage.prototype.mouseDown = function (event) {\n        return this;\n    };\n    StartDragMessage.prototype.mouseUp = function (event) {\n        this.context.view.select(this.message);\n        this.context.refresh(false);\n        return new IdleState(this.context);\n    };\n    StartDragMessage.prototype.mouseMove = function (event) {\n        if (event.distance(this.startDrag) > 10) {\n            return new DragMessage(this.context, event, this.message);\n        }\n        return this;\n    };\n    return StartDragMessage;\n}());\nexports.StartDragMessage = StartDragMessage;\nvar DragMessage = /** @class */ (function () {\n    function DragMessage(context, dragPoint, message) {\n        this.context = context;\n        this.dragPoint = dragPoint;\n        this.message = message;\n        this.context.view.startDragMessage(message, dragPoint.y);\n        this.context.refresh(false);\n    }\n    DragMessage.prototype.mouseDown = function (event) {\n        return this;\n    };\n    DragMessage.prototype.mouseUp = function (event) {\n        this.context.view.finishDragMessage(this.context.commandStack);\n        this.context.view.select(this.message);\n        this.context.refresh(true); // TODO test command stack if need to refresh\n        return new IdleState(this.context);\n    };\n    DragMessage.prototype.mouseMove = function (event) {\n        this.context.view.updateDragMessage(event.y);\n        this.context.refresh(false);\n        return this;\n    };\n    return DragMessage;\n}());\nexports.DragMessage = DragMessage;\nvar StartDragLifeLine = /** @class */ (function () {\n    function StartDragLifeLine(context, startDrag, lifeLine) {\n        this.context = context;\n        this.startDrag = startDrag;\n        this.lifeLine = lifeLine;\n    }\n    StartDragLifeLine.prototype.mouseDown = function (event) {\n        return this;\n    };\n    StartDragLifeLine.prototype.mouseUp = function (event) {\n        return new IdleState(this.context);\n    };\n    StartDragLifeLine.prototype.mouseMove = function (event) {\n        if (event.distance(this.startDrag) > 10) {\n            return new DragLifeLine(this.context, event, this.lifeLine);\n        }\n        return this;\n    };\n    return StartDragLifeLine;\n}());\nexports.StartDragLifeLine = StartDragLifeLine;\nvar DragLifeLine = /** @class */ (function () {\n    function DragLifeLine(context, dragPoint, lifeLine) {\n        this.context = context;\n        this.dragPoint = dragPoint;\n        this.lifeLine = lifeLine;\n        this.context.view.startDragLifeLine(this.lifeLine, dragPoint.x);\n        this.context.refresh(false);\n    }\n    DragLifeLine.prototype.mouseDown = function (event) {\n        return this;\n    };\n    DragLifeLine.prototype.mouseUp = function (event) {\n        this.context.view.finishDragLifeLine(this.context.commandStack);\n        this.context.refresh(true); // TODO test command stack if need to refresh\n        return new IdleState(this.context);\n    };\n    DragLifeLine.prototype.mouseMove = function (event) {\n        this.context.view.updateDragLifeLine(event.x);\n        this.context.refresh(false);\n        return this;\n    };\n    return DragLifeLine;\n}());\nexports.DragLifeLine = DragLifeLine;\n","\"use strict\";\nexports.__esModule = true;\nexports.CommandStack = void 0;\nvar CommandStack = /** @class */ (function () {\n    function CommandStack() {\n        this.stack = [];\n        this.current = -1;\n    }\n    CommandStack.prototype.execute = function (command) {\n        if (this.current + 1 < this.stack.length) {\n            this.stack.splice(this.current + 1, this.stack.length - this.current);\n        }\n        this.stack.push(command);\n        this.current += 1;\n        command.execute();\n    };\n    CommandStack.prototype.canUndo = function () {\n        return this.current >= 0;\n    };\n    CommandStack.prototype.canRedo = function () {\n        return this.current + 1 < this.stack.length;\n    };\n    CommandStack.prototype.undo = function () {\n        if (this.canUndo()) {\n            this.stack[this.current].undo();\n            this.current -= 1;\n        }\n    };\n    CommandStack.prototype.redo = function () {\n        if (this.canRedo()) {\n            this.current += 1;\n            this.stack[this.current].redo();\n        }\n    };\n    return CommandStack;\n}());\nexports.CommandStack = CommandStack;\n","\"use strict\";\nexports.__esModule = true;\nexports.Renderer = exports.MessageHandle = exports.MessageView = exports.LifelineView = exports.PendingLifeLineView = exports.PendingDragMessageView = exports.PendingMessageView = exports.DiagramView = void 0;\nvar geometry_1 = require(\"./geometry\");\nvar model_1 = require(\"./model\");\nvar DiagramView = /** @class */ (function () {\n    function DiagramView(model, style, lifeLines, messages) {\n        this.model = model;\n        this.style = style;\n        this.lifeLines = lifeLines;\n        this.messages = messages;\n        this.messageStart = 0;\n        this.pendingMessage = null;\n        this.pendingDragMessage = null;\n        this.pendingLifeLine = null;\n    }\n    DiagramView.prototype.testHover = function (event) {\n        var changed = false;\n        this.messages.forEach(function (message) {\n            changed || (changed = message.testHover(event));\n        });\n        this.lifeLines.forEach(function (lifeLine) {\n            changed || (changed = lifeLine.testHover(event));\n        });\n        return changed;\n    };\n    DiagramView.prototype.startPendingMessage = function (handle, to) {\n        this.pendingMessage = new PendingMessageView(handle, to);\n    };\n    DiagramView.prototype.updatePendingMessage = function (x) {\n        var _this = this;\n        this.pendingMessage.setPosition(x);\n        this.pendingMessage.hoverOther = null;\n        this.lifeLines.forEach(function (lifeline) {\n            if (Math.abs(lifeline.centerX() - x) < 10) {\n                _this.pendingMessage.setHover(lifeline, x);\n            }\n        });\n    };\n    DiagramView.prototype.finishPendingMessage = function (commandStack) {\n        this.pendingMessage.finish(commandStack);\n        this.pendingMessage = null;\n    };\n    DiagramView.prototype.startDragMessage = function (message, y) {\n        this.pendingDragMessage = new PendingDragMessageView(this, message, y);\n    };\n    DiagramView.prototype.updateDragMessage = function (y) {\n        this.pendingDragMessage.setPosition(y);\n    };\n    DiagramView.prototype.finishDragMessage = function (commandStack) {\n        this.pendingDragMessage.finish(commandStack);\n        this.pendingDragMessage = null;\n    };\n    DiagramView.prototype.startDragLifeLine = function (lifeLine, x) {\n        this.pendingLifeLine = new PendingLifeLineView(this, lifeLine, x);\n    };\n    DiagramView.prototype.updateDragLifeLine = function (x) {\n        this.pendingLifeLine.update(x);\n    };\n    DiagramView.prototype.finishDragLifeLine = function (commandStack) {\n        this.pendingLifeLine.finish(commandStack);\n        this.pendingLifeLine = null;\n    };\n    DiagramView.prototype.findMessageHandle = function (event) {\n        for (var _i = 0, _a = this.messages; _i < _a.length; _i++) {\n            var message = _a[_i];\n            if (message.from.bounds().contains(event)) {\n                return message.from;\n            }\n            if (message.to.bounds().contains(event)) {\n                return message.to;\n            }\n        }\n        return null;\n    };\n    DiagramView.prototype.findMessage = function (event) {\n        return this.messages.find(function (message) { return message.markerBounds.contains(event); });\n    };\n    DiagramView.prototype.findLifeLine = function (event) {\n        return this.lifeLines.find(function (lifeLine) { return lifeLine.hoverBounds.contains(event); });\n    };\n    DiagramView.prototype.layout = function () {\n        var _this = this;\n        this.messageStart = 0;\n        this.lifeLines.forEach(function (lifeLine) {\n            _this.messageStart = Math.max(_this.messageStart, lifeLine.headHeight);\n        });\n        var y = this.layoutMessages(this);\n        this.lifeLines.forEach(function (lifeLine) {\n            lifeLine.x = _this.style.leftMargin;\n            lifeLine.y = _this.style.topMargin;\n            lifeLine.lineHeight = y - _this.messageStart;\n        });\n        // space lifeLines following constraints\n        this.lifeLines.forEach(function (lifeLine) {\n            _this.messages.forEach(function (message) {\n                var messageWidth = message.width + _this.style.messageMargin * 2;\n                if (message.from.lifeLine == lifeLine && message.to.lifeLine.index < lifeLine.index) {\n                    var diff = lifeLine.centerX() - message.to.lifeLine.centerX();\n                    if (diff < messageWidth) {\n                        lifeLine.x += messageWidth - diff;\n                    }\n                }\n                else if (message.to.lifeLine == lifeLine && message.from.lifeLine.index < lifeLine.index) {\n                    var diff = lifeLine.centerX() - message.from.lifeLine.centerX();\n                    if (diff < messageWidth) {\n                        lifeLine.x += messageWidth - diff;\n                    }\n                }\n            });\n            if (lifeLine.index > 0) {\n                var prev = _this.lifeLines[lifeLine.index - 1];\n                var minDiff = prev.width + _this.style.minHeadGap;\n                var actualDiff = lifeLine.x - prev.x;\n                if (actualDiff < minDiff) {\n                    lifeLine.x = prev.x + minDiff;\n                }\n            }\n        });\n        this.lifeLines.forEach(function (lifeLine) { return lifeLine.layout(); });\n        this.messages.forEach(function (message) { return message.layout(); });\n    };\n    DiagramView.prototype.layoutMessages = function (diagram) {\n        var _this = this;\n        var y = diagram.messageStart + this.style.messageStartGap;\n        diagram.messages.forEach(function (message) {\n            message.y = y;\n            y += _this.style.messageGap;\n        });\n        return y;\n    };\n    DiagramView.prototype.select = function (message) {\n        this.messages.forEach(function (message) { return message.selected = false; });\n        if (message) {\n            // TODO display tools\n            message.selected = true;\n        }\n    };\n    return DiagramView;\n}());\nexports.DiagramView = DiagramView;\nvar PendingMessageView = /** @class */ (function () {\n    function PendingMessageView(handle, pos) {\n        this.handle = handle;\n        this.hoverOther = null;\n        this.y = handle.message.y;\n        this.otherHandle = handle.message.other(handle);\n        if (handle == handle.message.from) {\n            this.from = pos;\n            this.to = this.otherHandle.lifeLine.centerX();\n        }\n        else {\n            this.from = this.otherHandle.lifeLine.centerX();\n            this.to = pos;\n        }\n        this.handle.setHover(false);\n        this.handle.message.editing = true;\n    }\n    PendingMessageView.prototype.setPosition = function (pos) {\n        if (this.handle == this.handle.message.from) {\n            this.from = pos;\n        }\n        else {\n            this.to = pos;\n        }\n    };\n    PendingMessageView.prototype.setHover = function (lifeline, pos) {\n        if (lifeline != this.otherHandle.lifeLine) {\n            this.hoverOther = lifeline;\n            this.setPosition(this.hoverOther.centerX());\n        }\n        else {\n            this.hoverOther = null;\n            this.setPosition(pos);\n        }\n    };\n    PendingMessageView.prototype.finish = function (commandStack) {\n        this.handle.message.editing = false;\n        if (this.hoverOther != null && this.hoverOther != this.otherHandle.lifeLine) {\n            if (this.handle.message.from == this.handle) {\n                commandStack.execute(new model_1.SetMessageFromCommand(this.handle.message.model, this.hoverOther.model));\n            }\n            else {\n                commandStack.execute(new model_1.SetMessageToCommand(this.handle.message.model, this.hoverOther.model));\n            }\n        }\n    };\n    return PendingMessageView;\n}());\nexports.PendingMessageView = PendingMessageView;\nvar PendingDragMessageView = /** @class */ (function () {\n    function PendingDragMessageView(diagram, message, y) {\n        this.diagram = diagram;\n        this.message = message;\n        this.y = y;\n        this.message.y = y;\n        this.oldPosition = diagram.messages.indexOf(message);\n        this.message.hover = false;\n    }\n    PendingDragMessageView.prototype.setPosition = function (y) {\n        for (var _i = 0, _a = this.diagram.messages; _i < _a.length; _i++) {\n            var message = _a[_i];\n            if (message != this.message\n                && message.markerBounds.y <= y && y <= message.markerBounds.corner().y) {\n                var diff = Math.sign(message.markerBounds.center().y - y);\n                var offset = diff > 0 ? 1 : 0;\n                this.diagram.messages.splice(this.diagram.messages.indexOf(this.message), 1);\n                this.diagram.messages.splice(this.diagram.messages.indexOf(message) + offset, 0, this.message);\n                this.diagram.layout();\n            }\n        }\n        this.message.y = y;\n    };\n    PendingDragMessageView.prototype.finish = function (commandStack) {\n        var newPosition = this.diagram.messages.indexOf(this.message);\n        if (newPosition != this.oldPosition) {\n            commandStack.execute(new model_1.MoveMessageCommand(this.diagram.model, this.message.model, newPosition));\n        }\n    };\n    return PendingDragMessageView;\n}());\nexports.PendingDragMessageView = PendingDragMessageView;\nvar PendingLifeLineView = /** @class */ (function () {\n    function PendingLifeLineView(diagram, lifeLine, position) {\n        this.diagram = diagram;\n        this.lifeLine = lifeLine;\n        this.snap = false;\n        this.position = -1;\n        this.x = position;\n        this.y = this.lifeLine.y;\n        this.width = this.lifeLine.width;\n        this.height = this.lifeLine.headHeight + this.lifeLine.lineHeight;\n    }\n    PendingLifeLineView.prototype.update = function (x) {\n        this.x = x;\n        this.snap = false;\n        this.position = -1;\n        var prev = null;\n        for (var _i = 0, _a = this.diagram.lifeLines; _i < _a.length; _i++) {\n            var lifeLine = _a[_i];\n            if (prev) {\n                var mid = (prev.x + prev.width + lifeLine.x) / 2;\n                if (Math.abs(mid - x) < 10) {\n                    this.x = mid;\n                    this.snap = true;\n                    this.position = this.diagram.lifeLines.indexOf(lifeLine);\n                    break;\n                }\n            }\n            else if (x < lifeLine.x) {\n                this.x = lifeLine.x - 10;\n                this.snap = true;\n                this.position = 0;\n                break;\n            }\n            prev = lifeLine;\n        }\n        if (!this.snap && prev && x > (prev.x + prev.width)) {\n            this.x = prev.x + prev.width + 10;\n            this.snap = true;\n            this.position = this.diagram.lifeLines.indexOf(prev) + 1;\n        }\n    };\n    PendingLifeLineView.prototype.finish = function (commandStack) {\n        if (this.position > this.lifeLine.index) {\n            this.position -= 1;\n        }\n        var oldPosition = this.diagram.lifeLines.indexOf(this.lifeLine);\n        if (this.position >= 0 && this.position != oldPosition) {\n            commandStack.execute(new model_1.MoveLifeLineCommand(this.diagram.model, this.lifeLine.model, this.position));\n        }\n    };\n    return PendingLifeLineView;\n}());\nexports.PendingLifeLineView = PendingLifeLineView;\nvar LifelineView = /** @class */ (function () {\n    function LifelineView(options) {\n        this.lineHeight = 0;\n        this.x = 0;\n        this.y = 0;\n        this.selected = false;\n        this.hover = false;\n        this.model = options.model;\n        this.text = options.text;\n        this.index = options.index;\n        this.textSize = options.textSize;\n        this.width = options.width;\n        this.ascent = options.ascent;\n        this.headHeight = options.headHeight;\n    }\n    LifelineView.prototype.centerX = function () {\n        return this.x + this.width / 2;\n    };\n    LifelineView.prototype.testHover = function (mousePoint) {\n        return this.setHover(this.hoverBounds.contains(mousePoint));\n    };\n    LifelineView.prototype.setHover = function (value) {\n        if (this.hover != value) {\n            this.hover = value;\n            return true;\n        }\n        return false;\n    };\n    LifelineView.prototype.layout = function () {\n        this.hoverBounds = new geometry_1.Point(this.x, this.y).rect(this.width, this.headHeight).expand(10);\n        this.markerBounds = new geometry_1.Point(this.x, this.y).rect(this.width, this.headHeight + this.lineHeight).expand(10);\n    };\n    return LifelineView;\n}());\nexports.LifelineView = LifelineView;\nvar MessageView = /** @class */ (function () {\n    function MessageView(options) {\n        this.selected = false;\n        this.hover = false;\n        this.markerBounds = null;\n        this.y = 0;\n        this.editing = false;\n        this.model = options.model;\n        this.from = new MessageHandle(options.from, this);\n        this.to = new MessageHandle(options.to, this);\n        this.reversed = this.from.lifeLine.index > this.to.lifeLine.index;\n        this.text = options.text;\n        this.textSize = options.textSize;\n        this.width = options.width;\n        this.ascent = options.ascent;\n        this.height = options.height;\n        this.selected = options.selected;\n    }\n    MessageView.prototype.testHover = function (mousePoint) {\n        var changed = false;\n        if (this.markerBounds.contains(mousePoint)) {\n            changed || (changed = this.setHover(true));\n            changed || (changed = this.from.setHover(this.from.bounds().contains(mousePoint)));\n            changed || (changed = this.to.setHover(this.to.bounds().contains(mousePoint)));\n        }\n        else {\n            changed || (changed = this.setHover(false));\n            changed || (changed = this.from.setHover(false));\n            changed || (changed = this.to.setHover(false));\n        }\n        return changed;\n    };\n    MessageView.prototype.setHover = function (value) {\n        if (this.hover != value) {\n            this.hover = value;\n            return true;\n        }\n        return false;\n    };\n    MessageView.prototype.layout = function () {\n        this.markerBounds = new geometry_1.Rectangle(Math.min(this.from.lifeLine.centerX() - 10, this.to.lifeLine.centerX() - 10), this.y - this.height - 7, Math.abs(this.from.lifeLine.centerX() - this.to.lifeLine.centerX()) + 20, this.height + 20);\n    };\n    MessageView.prototype.other = function (handle) {\n        if (handle == this.from) {\n            return this.to;\n        }\n        return this.from;\n    };\n    return MessageView;\n}());\nexports.MessageView = MessageView;\nvar MessageHandle = /** @class */ (function () {\n    function MessageHandle(lifeLine, message) {\n        this.lifeLine = lifeLine;\n        this.message = message;\n        this.hover = false;\n    }\n    MessageHandle.prototype.center = function () {\n        return new geometry_1.Point(this.lifeLine.centerX(), this.message.y);\n    };\n    MessageHandle.prototype.bounds = function () {\n        return this.center().centeredRect(20, 20);\n    };\n    MessageHandle.prototype.setHover = function (value) {\n        if (this.hover != value) {\n            this.hover = value;\n            return true;\n        }\n        return false;\n    };\n    return MessageHandle;\n}());\nexports.MessageHandle = MessageHandle;\nvar Renderer = /** @class */ (function () {\n    function Renderer(style, measurer) {\n        this.style = style;\n        this.measurer = measurer;\n    }\n    Renderer.prototype.render = function (model) {\n        var _this = this;\n        var lifeLines = model.lifeLines.map(function (text, i) { return _this.createLifeline(text, i); });\n        var lifeLineMap = {};\n        lifeLines.forEach(function (lifeLine) {\n            lifeLineMap[lifeLine.model.id] = lifeLine;\n        });\n        var messages = model.messages.map(function (message) { return _this.createMessage(message, lifeLineMap); });\n        var view = new DiagramView(model, this.style, lifeLines, messages);\n        view.layout();\n        return view;\n    };\n    Renderer.prototype.createLifeline = function (lifeLine, index) {\n        var metrics = this.measurer.measure(lifeLine.name, this.style.lifeLineHeadTextSize);\n        var headHeight = Math.max(metrics.actualBoundingBoxAscent\n            + metrics.actualBoundingBoxDescent + this.style.lifeLineHeadMargin * 2, this.style.minHeadHeight);\n        return new LifelineView({\n            model: lifeLine,\n            text: lifeLine.name,\n            index: index,\n            textSize: this.style.lifeLineHeadTextSize,\n            width: metrics.width + this.style.lifeLineHeadMargin * 2,\n            ascent: metrics.actualBoundingBoxAscent,\n            headHeight: headHeight\n        });\n    };\n    Renderer.prototype.createMessage = function (message, lifeLineMap) {\n        var metrics = this.measurer.measure(message.text, this.style.messageTextSize);\n        var from = lifeLineMap[message.from.id];\n        var to = lifeLineMap[message.to.id];\n        return new MessageView({\n            model: message,\n            from: from,\n            to: to,\n            text: message.text,\n            textSize: this.style.messageTextSize,\n            width: metrics.width,\n            ascent: metrics.actualBoundingBoxAscent,\n            height: metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent,\n        });\n    };\n    return Renderer;\n}());\nexports.Renderer = Renderer;\n","function noop() { }\nconst identity = x => x;\nfunction assign(tar, src) {\n    // @ts-ignore\n    for (const k in src)\n        tar[k] = src[k];\n    return tar;\n}\nfunction is_promise(value) {\n    return value && typeof value === 'object' && typeof value.then === 'function';\n}\nfunction add_location(element, file, line, column, char) {\n    element.__svelte_meta = {\n        loc: { file, line, column, char }\n    };\n}\nfunction run(fn) {\n    return fn();\n}\nfunction blank_object() {\n    return Object.create(null);\n}\nfunction run_all(fns) {\n    fns.forEach(run);\n}\nfunction is_function(thing) {\n    return typeof thing === 'function';\n}\nfunction safe_not_equal(a, b) {\n    return a != a ? b == b : a !== b || ((a && typeof a === 'object') || typeof a === 'function');\n}\nfunction not_equal(a, b) {\n    return a != a ? b == b : a !== b;\n}\nfunction is_empty(obj) {\n    return Object.keys(obj).length === 0;\n}\nfunction validate_store(store, name) {\n    if (store != null && typeof store.subscribe !== 'function') {\n        throw new Error(`'${name}' is not a store with a 'subscribe' method`);\n    }\n}\nfunction subscribe(store, ...callbacks) {\n    if (store == null) {\n        return noop;\n    }\n    const unsub = store.subscribe(...callbacks);\n    return unsub.unsubscribe ? () => unsub.unsubscribe() : unsub;\n}\nfunction get_store_value(store) {\n    let value;\n    subscribe(store, _ => value = _)();\n    return value;\n}\nfunction component_subscribe(component, store, callback) {\n    component.$$.on_destroy.push(subscribe(store, callback));\n}\nfunction create_slot(definition, ctx, $$scope, fn) {\n    if (definition) {\n        const slot_ctx = get_slot_context(definition, ctx, $$scope, fn);\n        return definition[0](slot_ctx);\n    }\n}\nfunction get_slot_context(definition, ctx, $$scope, fn) {\n    return definition[1] && fn\n        ? assign($$scope.ctx.slice(), definition[1](fn(ctx)))\n        : $$scope.ctx;\n}\nfunction get_slot_changes(definition, $$scope, dirty, fn) {\n    if (definition[2] && fn) {\n        const lets = definition[2](fn(dirty));\n        if ($$scope.dirty === undefined) {\n            return lets;\n        }\n        if (typeof lets === 'object') {\n            const merged = [];\n            const len = Math.max($$scope.dirty.length, lets.length);\n            for (let i = 0; i < len; i += 1) {\n                merged[i] = $$scope.dirty[i] | lets[i];\n            }\n            return merged;\n        }\n        return $$scope.dirty | lets;\n    }\n    return $$scope.dirty;\n}\nfunction update_slot(slot, slot_definition, ctx, $$scope, dirty, get_slot_changes_fn, get_slot_context_fn) {\n    const slot_changes = get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n    if (slot_changes) {\n        const slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n        slot.p(slot_context, slot_changes);\n    }\n}\nfunction update_slot_spread(slot, slot_definition, ctx, $$scope, dirty, get_slot_changes_fn, get_slot_spread_changes_fn, get_slot_context_fn) {\n    const slot_changes = get_slot_spread_changes_fn(dirty) | get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n    if (slot_changes) {\n        const slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n        slot.p(slot_context, slot_changes);\n    }\n}\nfunction exclude_internal_props(props) {\n    const result = {};\n    for (const k in props)\n        if (k[0] !== '$')\n            result[k] = props[k];\n    return result;\n}\nfunction compute_rest_props(props, keys) {\n    const rest = {};\n    keys = new Set(keys);\n    for (const k in props)\n        if (!keys.has(k) && k[0] !== '$')\n            rest[k] = props[k];\n    return rest;\n}\nfunction compute_slots(slots) {\n    const result = {};\n    for (const key in slots) {\n        result[key] = true;\n    }\n    return result;\n}\nfunction once(fn) {\n    let ran = false;\n    return function (...args) {\n        if (ran)\n            return;\n        ran = true;\n        fn.call(this, ...args);\n    };\n}\nfunction null_to_empty(value) {\n    return value == null ? '' : value;\n}\nfunction set_store_value(store, ret, value = ret) {\n    store.set(value);\n    return ret;\n}\nconst has_prop = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\nfunction action_destroyer(action_result) {\n    return action_result && is_function(action_result.destroy) ? action_result.destroy : noop;\n}\n\nconst is_client = typeof window !== 'undefined';\nlet now = is_client\n    ? () => window.performance.now()\n    : () => Date.now();\nlet raf = is_client ? cb => requestAnimationFrame(cb) : noop;\n// used internally for testing\nfunction set_now(fn) {\n    now = fn;\n}\nfunction set_raf(fn) {\n    raf = fn;\n}\n\nconst tasks = new Set();\nfunction run_tasks(now) {\n    tasks.forEach(task => {\n        if (!task.c(now)) {\n            tasks.delete(task);\n            task.f();\n        }\n    });\n    if (tasks.size !== 0)\n        raf(run_tasks);\n}\n/**\n * For testing purposes only!\n */\nfunction clear_loops() {\n    tasks.clear();\n}\n/**\n * Creates a new task that runs on each raf frame\n * until it returns a falsy value or is aborted\n */\nfunction loop(callback) {\n    let task;\n    if (tasks.size === 0)\n        raf(run_tasks);\n    return {\n        promise: new Promise(fulfill => {\n            tasks.add(task = { c: callback, f: fulfill });\n        }),\n        abort() {\n            tasks.delete(task);\n        }\n    };\n}\n\nfunction append(target, node) {\n    target.appendChild(node);\n}\nfunction insert(target, node, anchor) {\n    target.insertBefore(node, anchor || null);\n}\nfunction detach(node) {\n    node.parentNode.removeChild(node);\n}\nfunction destroy_each(iterations, detaching) {\n    for (let i = 0; i < iterations.length; i += 1) {\n        if (iterations[i])\n            iterations[i].d(detaching);\n    }\n}\nfunction element(name) {\n    return document.createElement(name);\n}\nfunction element_is(name, is) {\n    return document.createElement(name, { is });\n}\nfunction object_without_properties(obj, exclude) {\n    const target = {};\n    for (const k in obj) {\n        if (has_prop(obj, k)\n            // @ts-ignore\n            && exclude.indexOf(k) === -1) {\n            // @ts-ignore\n            target[k] = obj[k];\n        }\n    }\n    return target;\n}\nfunction svg_element(name) {\n    return document.createElementNS('http://www.w3.org/2000/svg', name);\n}\nfunction text(data) {\n    return document.createTextNode(data);\n}\nfunction space() {\n    return text(' ');\n}\nfunction empty() {\n    return text('');\n}\nfunction listen(node, event, handler, options) {\n    node.addEventListener(event, handler, options);\n    return () => node.removeEventListener(event, handler, options);\n}\nfunction prevent_default(fn) {\n    return function (event) {\n        event.preventDefault();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction stop_propagation(fn) {\n    return function (event) {\n        event.stopPropagation();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction self(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.target === this)\n            fn.call(this, event);\n    };\n}\nfunction attr(node, attribute, value) {\n    if (value == null)\n        node.removeAttribute(attribute);\n    else if (node.getAttribute(attribute) !== value)\n        node.setAttribute(attribute, value);\n}\nfunction set_attributes(node, attributes) {\n    // @ts-ignore\n    const descriptors = Object.getOwnPropertyDescriptors(node.__proto__);\n    for (const key in attributes) {\n        if (attributes[key] == null) {\n            node.removeAttribute(key);\n        }\n        else if (key === 'style') {\n            node.style.cssText = attributes[key];\n        }\n        else if (key === '__value') {\n            node.value = node[key] = attributes[key];\n        }\n        else if (descriptors[key] && descriptors[key].set) {\n            node[key] = attributes[key];\n        }\n        else {\n            attr(node, key, attributes[key]);\n        }\n    }\n}\nfunction set_svg_attributes(node, attributes) {\n    for (const key in attributes) {\n        attr(node, key, attributes[key]);\n    }\n}\nfunction set_custom_element_data(node, prop, value) {\n    if (prop in node) {\n        node[prop] = value;\n    }\n    else {\n        attr(node, prop, value);\n    }\n}\nfunction xlink_attr(node, attribute, value) {\n    node.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\nfunction get_binding_group_value(group, __value, checked) {\n    const value = new Set();\n    for (let i = 0; i < group.length; i += 1) {\n        if (group[i].checked)\n            value.add(group[i].__value);\n    }\n    if (!checked) {\n        value.delete(__value);\n    }\n    return Array.from(value);\n}\nfunction to_number(value) {\n    return value === '' ? null : +value;\n}\nfunction time_ranges_to_array(ranges) {\n    const array = [];\n    for (let i = 0; i < ranges.length; i += 1) {\n        array.push({ start: ranges.start(i), end: ranges.end(i) });\n    }\n    return array;\n}\nfunction children(element) {\n    return Array.from(element.childNodes);\n}\nfunction claim_element(nodes, name, attributes, svg) {\n    for (let i = 0; i < nodes.length; i += 1) {\n        const node = nodes[i];\n        if (node.nodeName === name) {\n            let j = 0;\n            const remove = [];\n            while (j < node.attributes.length) {\n                const attribute = node.attributes[j++];\n                if (!attributes[attribute.name]) {\n                    remove.push(attribute.name);\n                }\n            }\n            for (let k = 0; k < remove.length; k++) {\n                node.removeAttribute(remove[k]);\n            }\n            return nodes.splice(i, 1)[0];\n        }\n    }\n    return svg ? svg_element(name) : element(name);\n}\nfunction claim_text(nodes, data) {\n    for (let i = 0; i < nodes.length; i += 1) {\n        const node = nodes[i];\n        if (node.nodeType === 3) {\n            node.data = '' + data;\n            return nodes.splice(i, 1)[0];\n        }\n    }\n    return text(data);\n}\nfunction claim_space(nodes) {\n    return claim_text(nodes, ' ');\n}\nfunction set_data(text, data) {\n    data = '' + data;\n    if (text.wholeText !== data)\n        text.data = data;\n}\nfunction set_input_value(input, value) {\n    input.value = value == null ? '' : value;\n}\nfunction set_input_type(input, type) {\n    try {\n        input.type = type;\n    }\n    catch (e) {\n        // do nothing\n    }\n}\nfunction set_style(node, key, value, important) {\n    node.style.setProperty(key, value, important ? 'important' : '');\n}\nfunction select_option(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        if (option.__value === value) {\n            option.selected = true;\n            return;\n        }\n    }\n}\nfunction select_options(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        option.selected = ~value.indexOf(option.__value);\n    }\n}\nfunction select_value(select) {\n    const selected_option = select.querySelector(':checked') || select.options[0];\n    return selected_option && selected_option.__value;\n}\nfunction select_multiple_value(select) {\n    return [].map.call(select.querySelectorAll(':checked'), option => option.__value);\n}\n// unfortunately this can't be a constant as that wouldn't be tree-shakeable\n// so we cache the result instead\nlet crossorigin;\nfunction is_crossorigin() {\n    if (crossorigin === undefined) {\n        crossorigin = false;\n        try {\n            if (typeof window !== 'undefined' && window.parent) {\n                void window.parent.document;\n            }\n        }\n        catch (error) {\n            crossorigin = true;\n        }\n    }\n    return crossorigin;\n}\nfunction add_resize_listener(node, fn) {\n    const computed_style = getComputedStyle(node);\n    if (computed_style.position === 'static') {\n        node.style.position = 'relative';\n    }\n    const iframe = element('iframe');\n    iframe.setAttribute('style', 'display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; ' +\n        'overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;');\n    iframe.setAttribute('aria-hidden', 'true');\n    iframe.tabIndex = -1;\n    const crossorigin = is_crossorigin();\n    let unsubscribe;\n    if (crossorigin) {\n        iframe.src = \"data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}</script>\";\n        unsubscribe = listen(window, 'message', (event) => {\n            if (event.source === iframe.contentWindow)\n                fn();\n        });\n    }\n    else {\n        iframe.src = 'about:blank';\n        iframe.onload = () => {\n            unsubscribe = listen(iframe.contentWindow, 'resize', fn);\n        };\n    }\n    append(node, iframe);\n    return () => {\n        if (crossorigin) {\n            unsubscribe();\n        }\n        else if (unsubscribe && iframe.contentWindow) {\n            unsubscribe();\n        }\n        detach(iframe);\n    };\n}\nfunction toggle_class(element, name, toggle) {\n    element.classList[toggle ? 'add' : 'remove'](name);\n}\nfunction custom_event(type, detail) {\n    const e = document.createEvent('CustomEvent');\n    e.initCustomEvent(type, false, false, detail);\n    return e;\n}\nfunction query_selector_all(selector, parent = document.body) {\n    return Array.from(parent.querySelectorAll(selector));\n}\nclass HtmlTag {\n    constructor(anchor = null) {\n        this.a = anchor;\n        this.e = this.n = null;\n    }\n    m(html, target, anchor = null) {\n        if (!this.e) {\n            this.e = element(target.nodeName);\n            this.t = target;\n            this.h(html);\n        }\n        this.i(anchor);\n    }\n    h(html) {\n        this.e.innerHTML = html;\n        this.n = Array.from(this.e.childNodes);\n    }\n    i(anchor) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert(this.t, this.n[i], anchor);\n        }\n    }\n    p(html) {\n        this.d();\n        this.h(html);\n        this.i(this.a);\n    }\n    d() {\n        this.n.forEach(detach);\n    }\n}\nfunction attribute_to_object(attributes) {\n    const result = {};\n    for (const attribute of attributes) {\n        result[attribute.name] = attribute.value;\n    }\n    return result;\n}\nfunction get_custom_elements_slots(element) {\n    const result = {};\n    element.childNodes.forEach((node) => {\n        result[node.slot || 'default'] = true;\n    });\n    return result;\n}\n\nconst active_docs = new Set();\nlet active = 0;\n// https://github.com/darkskyapp/string-hash/blob/master/index.js\nfunction hash(str) {\n    let hash = 5381;\n    let i = str.length;\n    while (i--)\n        hash = ((hash << 5) - hash) ^ str.charCodeAt(i);\n    return hash >>> 0;\n}\nfunction create_rule(node, a, b, duration, delay, ease, fn, uid = 0) {\n    const step = 16.666 / duration;\n    let keyframes = '{\\n';\n    for (let p = 0; p <= 1; p += step) {\n        const t = a + (b - a) * ease(p);\n        keyframes += p * 100 + `%{${fn(t, 1 - t)}}\\n`;\n    }\n    const rule = keyframes + `100% {${fn(b, 1 - b)}}\\n}`;\n    const name = `__svelte_${hash(rule)}_${uid}`;\n    const doc = node.ownerDocument;\n    active_docs.add(doc);\n    const stylesheet = doc.__svelte_stylesheet || (doc.__svelte_stylesheet = doc.head.appendChild(element('style')).sheet);\n    const current_rules = doc.__svelte_rules || (doc.__svelte_rules = {});\n    if (!current_rules[name]) {\n        current_rules[name] = true;\n        stylesheet.insertRule(`@keyframes ${name} ${rule}`, stylesheet.cssRules.length);\n    }\n    const animation = node.style.animation || '';\n    node.style.animation = `${animation ? `${animation}, ` : ''}${name} ${duration}ms linear ${delay}ms 1 both`;\n    active += 1;\n    return name;\n}\nfunction delete_rule(node, name) {\n    const previous = (node.style.animation || '').split(', ');\n    const next = previous.filter(name\n        ? anim => anim.indexOf(name) < 0 // remove specific animation\n        : anim => anim.indexOf('__svelte') === -1 // remove all Svelte animations\n    );\n    const deleted = previous.length - next.length;\n    if (deleted) {\n        node.style.animation = next.join(', ');\n        active -= deleted;\n        if (!active)\n            clear_rules();\n    }\n}\nfunction clear_rules() {\n    raf(() => {\n        if (active)\n            return;\n        active_docs.forEach(doc => {\n            const stylesheet = doc.__svelte_stylesheet;\n            let i = stylesheet.cssRules.length;\n            while (i--)\n                stylesheet.deleteRule(i);\n            doc.__svelte_rules = {};\n        });\n        active_docs.clear();\n    });\n}\n\nfunction create_animation(node, from, fn, params) {\n    if (!from)\n        return noop;\n    const to = node.getBoundingClientRect();\n    if (from.left === to.left && from.right === to.right && from.top === to.top && from.bottom === to.bottom)\n        return noop;\n    const { delay = 0, duration = 300, easing = identity, \n    // @ts-ignore todo: should this be separated from destructuring? Or start/end added to public api and documentation?\n    start: start_time = now() + delay, \n    // @ts-ignore todo:\n    end = start_time + duration, tick = noop, css } = fn(node, { from, to }, params);\n    let running = true;\n    let started = false;\n    let name;\n    function start() {\n        if (css) {\n            name = create_rule(node, 0, 1, duration, delay, easing, css);\n        }\n        if (!delay) {\n            started = true;\n        }\n    }\n    function stop() {\n        if (css)\n            delete_rule(node, name);\n        running = false;\n    }\n    loop(now => {\n        if (!started && now >= start_time) {\n            started = true;\n        }\n        if (started && now >= end) {\n            tick(1, 0);\n            stop();\n        }\n        if (!running) {\n            return false;\n        }\n        if (started) {\n            const p = now - start_time;\n            const t = 0 + 1 * easing(p / duration);\n            tick(t, 1 - t);\n        }\n        return true;\n    });\n    start();\n    tick(0, 1);\n    return stop;\n}\nfunction fix_position(node) {\n    const style = getComputedStyle(node);\n    if (style.position !== 'absolute' && style.position !== 'fixed') {\n        const { width, height } = style;\n        const a = node.getBoundingClientRect();\n        node.style.position = 'absolute';\n        node.style.width = width;\n        node.style.height = height;\n        add_transform(node, a);\n    }\n}\nfunction add_transform(node, a) {\n    const b = node.getBoundingClientRect();\n    if (a.left !== b.left || a.top !== b.top) {\n        const style = getComputedStyle(node);\n        const transform = style.transform === 'none' ? '' : style.transform;\n        node.style.transform = `${transform} translate(${a.left - b.left}px, ${a.top - b.top}px)`;\n    }\n}\n\nlet current_component;\nfunction set_current_component(component) {\n    current_component = component;\n}\nfunction get_current_component() {\n    if (!current_component)\n        throw new Error('Function called outside component initialization');\n    return current_component;\n}\nfunction beforeUpdate(fn) {\n    get_current_component().$$.before_update.push(fn);\n}\nfunction onMount(fn) {\n    get_current_component().$$.on_mount.push(fn);\n}\nfunction afterUpdate(fn) {\n    get_current_component().$$.after_update.push(fn);\n}\nfunction onDestroy(fn) {\n    get_current_component().$$.on_destroy.push(fn);\n}\nfunction createEventDispatcher() {\n    const component = get_current_component();\n    return (type, detail) => {\n        const callbacks = component.$$.callbacks[type];\n        if (callbacks) {\n            // TODO are there situations where events could be dispatched\n            // in a server (non-DOM) environment?\n            const event = custom_event(type, detail);\n            callbacks.slice().forEach(fn => {\n                fn.call(component, event);\n            });\n        }\n    };\n}\nfunction setContext(key, context) {\n    get_current_component().$$.context.set(key, context);\n}\nfunction getContext(key) {\n    return get_current_component().$$.context.get(key);\n}\nfunction hasContext(key) {\n    return get_current_component().$$.context.has(key);\n}\n// TODO figure out if we still want to support\n// shorthand events, or if we want to implement\n// a real bubbling mechanism\nfunction bubble(component, event) {\n    const callbacks = component.$$.callbacks[event.type];\n    if (callbacks) {\n        callbacks.slice().forEach(fn => fn(event));\n    }\n}\n\nconst dirty_components = [];\nconst intros = { enabled: false };\nconst binding_callbacks = [];\nconst render_callbacks = [];\nconst flush_callbacks = [];\nconst resolved_promise = Promise.resolve();\nlet update_scheduled = false;\nfunction schedule_update() {\n    if (!update_scheduled) {\n        update_scheduled = true;\n        resolved_promise.then(flush);\n    }\n}\nfunction tick() {\n    schedule_update();\n    return resolved_promise;\n}\nfunction add_render_callback(fn) {\n    render_callbacks.push(fn);\n}\nfunction add_flush_callback(fn) {\n    flush_callbacks.push(fn);\n}\nlet flushing = false;\nconst seen_callbacks = new Set();\nfunction flush() {\n    if (flushing)\n        return;\n    flushing = true;\n    do {\n        // first, call beforeUpdate functions\n        // and update components\n        for (let i = 0; i < dirty_components.length; i += 1) {\n            const component = dirty_components[i];\n            set_current_component(component);\n            update(component.$$);\n        }\n        set_current_component(null);\n        dirty_components.length = 0;\n        while (binding_callbacks.length)\n            binding_callbacks.pop()();\n        // then, once components are updated, call\n        // afterUpdate functions. This may cause\n        // subsequent updates...\n        for (let i = 0; i < render_callbacks.length; i += 1) {\n            const callback = render_callbacks[i];\n            if (!seen_callbacks.has(callback)) {\n                // ...so guard against infinite loops\n                seen_callbacks.add(callback);\n                callback();\n            }\n        }\n        render_callbacks.length = 0;\n    } while (dirty_components.length);\n    while (flush_callbacks.length) {\n        flush_callbacks.pop()();\n    }\n    update_scheduled = false;\n    flushing = false;\n    seen_callbacks.clear();\n}\nfunction update($$) {\n    if ($$.fragment !== null) {\n        $$.update();\n        run_all($$.before_update);\n        const dirty = $$.dirty;\n        $$.dirty = [-1];\n        $$.fragment && $$.fragment.p($$.ctx, dirty);\n        $$.after_update.forEach(add_render_callback);\n    }\n}\n\nlet promise;\nfunction wait() {\n    if (!promise) {\n        promise = Promise.resolve();\n        promise.then(() => {\n            promise = null;\n        });\n    }\n    return promise;\n}\nfunction dispatch(node, direction, kind) {\n    node.dispatchEvent(custom_event(`${direction ? 'intro' : 'outro'}${kind}`));\n}\nconst outroing = new Set();\nlet outros;\nfunction group_outros() {\n    outros = {\n        r: 0,\n        c: [],\n        p: outros // parent group\n    };\n}\nfunction check_outros() {\n    if (!outros.r) {\n        run_all(outros.c);\n    }\n    outros = outros.p;\n}\nfunction transition_in(block, local) {\n    if (block && block.i) {\n        outroing.delete(block);\n        block.i(local);\n    }\n}\nfunction transition_out(block, local, detach, callback) {\n    if (block && block.o) {\n        if (outroing.has(block))\n            return;\n        outroing.add(block);\n        outros.c.push(() => {\n            outroing.delete(block);\n            if (callback) {\n                if (detach)\n                    block.d(1);\n                callback();\n            }\n        });\n        block.o(local);\n    }\n}\nconst null_transition = { duration: 0 };\nfunction create_in_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = false;\n    let animation_name;\n    let task;\n    let uid = 0;\n    function cleanup() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 0, 1, duration, delay, easing, css, uid++);\n        tick(0, 1);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        if (task)\n            task.abort();\n        running = true;\n        add_render_callback(() => dispatch(node, true, 'start'));\n        task = loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(1, 0);\n                    dispatch(node, true, 'end');\n                    cleanup();\n                    return running = false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(t, 1 - t);\n                }\n            }\n            return running;\n        });\n    }\n    let started = false;\n    return {\n        start() {\n            if (started)\n                return;\n            delete_rule(node);\n            if (is_function(config)) {\n                config = config();\n                wait().then(go);\n            }\n            else {\n                go();\n            }\n        },\n        invalidate() {\n            started = false;\n        },\n        end() {\n            if (running) {\n                cleanup();\n                running = false;\n            }\n        }\n    };\n}\nfunction create_out_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = true;\n    let animation_name;\n    const group = outros;\n    group.r += 1;\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 1, 0, duration, delay, easing, css);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        add_render_callback(() => dispatch(node, false, 'start'));\n        loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(0, 1);\n                    dispatch(node, false, 'end');\n                    if (!--group.r) {\n                        // this will result in `end()` being called,\n                        // so we don't need to clean up here\n                        run_all(group.c);\n                    }\n                    return false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(1 - t, t);\n                }\n            }\n            return running;\n        });\n    }\n    if (is_function(config)) {\n        wait().then(() => {\n            // @ts-ignore\n            config = config();\n            go();\n        });\n    }\n    else {\n        go();\n    }\n    return {\n        end(reset) {\n            if (reset && config.tick) {\n                config.tick(1, 0);\n            }\n            if (running) {\n                if (animation_name)\n                    delete_rule(node, animation_name);\n                running = false;\n            }\n        }\n    };\n}\nfunction create_bidirectional_transition(node, fn, params, intro) {\n    let config = fn(node, params);\n    let t = intro ? 0 : 1;\n    let running_program = null;\n    let pending_program = null;\n    let animation_name = null;\n    function clear_animation() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function init(program, duration) {\n        const d = program.b - t;\n        duration *= Math.abs(d);\n        return {\n            a: t,\n            b: program.b,\n            d,\n            duration,\n            start: program.start,\n            end: program.start + duration,\n            group: program.group\n        };\n    }\n    function go(b) {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        const program = {\n            start: now() + delay,\n            b\n        };\n        if (!b) {\n            // @ts-ignore todo: improve typings\n            program.group = outros;\n            outros.r += 1;\n        }\n        if (running_program || pending_program) {\n            pending_program = program;\n        }\n        else {\n            // if this is an intro, and there's a delay, we need to do\n            // an initial tick and/or apply CSS animation immediately\n            if (css) {\n                clear_animation();\n                animation_name = create_rule(node, t, b, duration, delay, easing, css);\n            }\n            if (b)\n                tick(0, 1);\n            running_program = init(program, duration);\n            add_render_callback(() => dispatch(node, b, 'start'));\n            loop(now => {\n                if (pending_program && now > pending_program.start) {\n                    running_program = init(pending_program, duration);\n                    pending_program = null;\n                    dispatch(node, running_program.b, 'start');\n                    if (css) {\n                        clear_animation();\n                        animation_name = create_rule(node, t, running_program.b, running_program.duration, 0, easing, config.css);\n                    }\n                }\n                if (running_program) {\n                    if (now >= running_program.end) {\n                        tick(t = running_program.b, 1 - t);\n                        dispatch(node, running_program.b, 'end');\n                        if (!pending_program) {\n                            // we're done\n                            if (running_program.b) {\n                                // intro  we can tidy up immediately\n                                clear_animation();\n                            }\n                            else {\n                                // outro  needs to be coordinated\n                                if (!--running_program.group.r)\n                                    run_all(running_program.group.c);\n                            }\n                        }\n                        running_program = null;\n                    }\n                    else if (now >= running_program.start) {\n                        const p = now - running_program.start;\n                        t = running_program.a + running_program.d * easing(p / running_program.duration);\n                        tick(t, 1 - t);\n                    }\n                }\n                return !!(running_program || pending_program);\n            });\n        }\n    }\n    return {\n        run(b) {\n            if (is_function(config)) {\n                wait().then(() => {\n                    // @ts-ignore\n                    config = config();\n                    go(b);\n                });\n            }\n            else {\n                go(b);\n            }\n        },\n        end() {\n            clear_animation();\n            running_program = pending_program = null;\n        }\n    };\n}\n\nfunction handle_promise(promise, info) {\n    const token = info.token = {};\n    function update(type, index, key, value) {\n        if (info.token !== token)\n            return;\n        info.resolved = value;\n        let child_ctx = info.ctx;\n        if (key !== undefined) {\n            child_ctx = child_ctx.slice();\n            child_ctx[key] = value;\n        }\n        const block = type && (info.current = type)(child_ctx);\n        let needs_flush = false;\n        if (info.block) {\n            if (info.blocks) {\n                info.blocks.forEach((block, i) => {\n                    if (i !== index && block) {\n                        group_outros();\n                        transition_out(block, 1, 1, () => {\n                            if (info.blocks[i] === block) {\n                                info.blocks[i] = null;\n                            }\n                        });\n                        check_outros();\n                    }\n                });\n            }\n            else {\n                info.block.d(1);\n            }\n            block.c();\n            transition_in(block, 1);\n            block.m(info.mount(), info.anchor);\n            needs_flush = true;\n        }\n        info.block = block;\n        if (info.blocks)\n            info.blocks[index] = block;\n        if (needs_flush) {\n            flush();\n        }\n    }\n    if (is_promise(promise)) {\n        const current_component = get_current_component();\n        promise.then(value => {\n            set_current_component(current_component);\n            update(info.then, 1, info.value, value);\n            set_current_component(null);\n        }, error => {\n            set_current_component(current_component);\n            update(info.catch, 2, info.error, error);\n            set_current_component(null);\n            if (!info.hasCatch) {\n                throw error;\n            }\n        });\n        // if we previously had a then/catch block, destroy it\n        if (info.current !== info.pending) {\n            update(info.pending, 0);\n            return true;\n        }\n    }\n    else {\n        if (info.current !== info.then) {\n            update(info.then, 1, info.value, promise);\n            return true;\n        }\n        info.resolved = promise;\n    }\n}\n\nconst globals = (typeof window !== 'undefined'\n    ? window\n    : typeof globalThis !== 'undefined'\n        ? globalThis\n        : global);\n\nfunction destroy_block(block, lookup) {\n    block.d(1);\n    lookup.delete(block.key);\n}\nfunction outro_and_destroy_block(block, lookup) {\n    transition_out(block, 1, 1, () => {\n        lookup.delete(block.key);\n    });\n}\nfunction fix_and_destroy_block(block, lookup) {\n    block.f();\n    destroy_block(block, lookup);\n}\nfunction fix_and_outro_and_destroy_block(block, lookup) {\n    block.f();\n    outro_and_destroy_block(block, lookup);\n}\nfunction update_keyed_each(old_blocks, dirty, get_key, dynamic, ctx, list, lookup, node, destroy, create_each_block, next, get_context) {\n    let o = old_blocks.length;\n    let n = list.length;\n    let i = o;\n    const old_indexes = {};\n    while (i--)\n        old_indexes[old_blocks[i].key] = i;\n    const new_blocks = [];\n    const new_lookup = new Map();\n    const deltas = new Map();\n    i = n;\n    while (i--) {\n        const child_ctx = get_context(ctx, list, i);\n        const key = get_key(child_ctx);\n        let block = lookup.get(key);\n        if (!block) {\n            block = create_each_block(key, child_ctx);\n            block.c();\n        }\n        else if (dynamic) {\n            block.p(child_ctx, dirty);\n        }\n        new_lookup.set(key, new_blocks[i] = block);\n        if (key in old_indexes)\n            deltas.set(key, Math.abs(i - old_indexes[key]));\n    }\n    const will_move = new Set();\n    const did_move = new Set();\n    function insert(block) {\n        transition_in(block, 1);\n        block.m(node, next);\n        lookup.set(block.key, block);\n        next = block.first;\n        n--;\n    }\n    while (o && n) {\n        const new_block = new_blocks[n - 1];\n        const old_block = old_blocks[o - 1];\n        const new_key = new_block.key;\n        const old_key = old_block.key;\n        if (new_block === old_block) {\n            // do nothing\n            next = new_block.first;\n            o--;\n            n--;\n        }\n        else if (!new_lookup.has(old_key)) {\n            // remove old block\n            destroy(old_block, lookup);\n            o--;\n        }\n        else if (!lookup.has(new_key) || will_move.has(new_key)) {\n            insert(new_block);\n        }\n        else if (did_move.has(old_key)) {\n            o--;\n        }\n        else if (deltas.get(new_key) > deltas.get(old_key)) {\n            did_move.add(new_key);\n            insert(new_block);\n        }\n        else {\n            will_move.add(old_key);\n            o--;\n        }\n    }\n    while (o--) {\n        const old_block = old_blocks[o];\n        if (!new_lookup.has(old_block.key))\n            destroy(old_block, lookup);\n    }\n    while (n)\n        insert(new_blocks[n - 1]);\n    return new_blocks;\n}\nfunction validate_each_keys(ctx, list, get_context, get_key) {\n    const keys = new Set();\n    for (let i = 0; i < list.length; i++) {\n        const key = get_key(get_context(ctx, list, i));\n        if (keys.has(key)) {\n            throw new Error('Cannot have duplicate keys in a keyed each');\n        }\n        keys.add(key);\n    }\n}\n\nfunction get_spread_update(levels, updates) {\n    const update = {};\n    const to_null_out = {};\n    const accounted_for = { $$scope: 1 };\n    let i = levels.length;\n    while (i--) {\n        const o = levels[i];\n        const n = updates[i];\n        if (n) {\n            for (const key in o) {\n                if (!(key in n))\n                    to_null_out[key] = 1;\n            }\n            for (const key in n) {\n                if (!accounted_for[key]) {\n                    update[key] = n[key];\n                    accounted_for[key] = 1;\n                }\n            }\n            levels[i] = n;\n        }\n        else {\n            for (const key in o) {\n                accounted_for[key] = 1;\n            }\n        }\n    }\n    for (const key in to_null_out) {\n        if (!(key in update))\n            update[key] = undefined;\n    }\n    return update;\n}\nfunction get_spread_object(spread_props) {\n    return typeof spread_props === 'object' && spread_props !== null ? spread_props : {};\n}\n\n// source: https://html.spec.whatwg.org/multipage/indices.html\nconst boolean_attributes = new Set([\n    'allowfullscreen',\n    'allowpaymentrequest',\n    'async',\n    'autofocus',\n    'autoplay',\n    'checked',\n    'controls',\n    'default',\n    'defer',\n    'disabled',\n    'formnovalidate',\n    'hidden',\n    'ismap',\n    'loop',\n    'multiple',\n    'muted',\n    'nomodule',\n    'novalidate',\n    'open',\n    'playsinline',\n    'readonly',\n    'required',\n    'reversed',\n    'selected'\n]);\n\nconst invalid_attribute_name_character = /[\\s'\">/=\\u{FDD0}-\\u{FDEF}\\u{FFFE}\\u{FFFF}\\u{1FFFE}\\u{1FFFF}\\u{2FFFE}\\u{2FFFF}\\u{3FFFE}\\u{3FFFF}\\u{4FFFE}\\u{4FFFF}\\u{5FFFE}\\u{5FFFF}\\u{6FFFE}\\u{6FFFF}\\u{7FFFE}\\u{7FFFF}\\u{8FFFE}\\u{8FFFF}\\u{9FFFE}\\u{9FFFF}\\u{AFFFE}\\u{AFFFF}\\u{BFFFE}\\u{BFFFF}\\u{CFFFE}\\u{CFFFF}\\u{DFFFE}\\u{DFFFF}\\u{EFFFE}\\u{EFFFF}\\u{FFFFE}\\u{FFFFF}\\u{10FFFE}\\u{10FFFF}]/u;\n// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\n// https://infra.spec.whatwg.org/#noncharacter\nfunction spread(args, classes_to_add) {\n    const attributes = Object.assign({}, ...args);\n    if (classes_to_add) {\n        if (attributes.class == null) {\n            attributes.class = classes_to_add;\n        }\n        else {\n            attributes.class += ' ' + classes_to_add;\n        }\n    }\n    let str = '';\n    Object.keys(attributes).forEach(name => {\n        if (invalid_attribute_name_character.test(name))\n            return;\n        const value = attributes[name];\n        if (value === true)\n            str += ' ' + name;\n        else if (boolean_attributes.has(name.toLowerCase())) {\n            if (value)\n                str += ' ' + name;\n        }\n        else if (value != null) {\n            str += ` ${name}=\"${String(value).replace(/\"/g, '&#34;').replace(/'/g, '&#39;')}\"`;\n        }\n    });\n    return str;\n}\nconst escaped = {\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;'\n};\nfunction escape(html) {\n    return String(html).replace(/[\"'&<>]/g, match => escaped[match]);\n}\nfunction each(items, fn) {\n    let str = '';\n    for (let i = 0; i < items.length; i += 1) {\n        str += fn(items[i], i);\n    }\n    return str;\n}\nconst missing_component = {\n    $$render: () => ''\n};\nfunction validate_component(component, name) {\n    if (!component || !component.$$render) {\n        if (name === 'svelte:component')\n            name += ' this={...}';\n        throw new Error(`<${name}> is not a valid SSR component. You may need to review your build config to ensure that dependencies are compiled, rather than imported as pre-compiled modules`);\n    }\n    return component;\n}\nfunction debug(file, line, column, values) {\n    console.log(`{@debug} ${file ? file + ' ' : ''}(${line}:${column})`); // eslint-disable-line no-console\n    console.log(values); // eslint-disable-line no-console\n    return '';\n}\nlet on_destroy;\nfunction create_ssr_component(fn) {\n    function $$render(result, props, bindings, slots) {\n        const parent_component = current_component;\n        const $$ = {\n            on_destroy,\n            context: new Map(parent_component ? parent_component.$$.context : []),\n            // these will be immediately discarded\n            on_mount: [],\n            before_update: [],\n            after_update: [],\n            callbacks: blank_object()\n        };\n        set_current_component({ $$ });\n        const html = fn(result, props, bindings, slots);\n        set_current_component(parent_component);\n        return html;\n    }\n    return {\n        render: (props = {}, options = {}) => {\n            on_destroy = [];\n            const result = { title: '', head: '', css: new Set() };\n            const html = $$render(result, props, {}, options);\n            run_all(on_destroy);\n            return {\n                html,\n                css: {\n                    code: Array.from(result.css).map(css => css.code).join('\\n'),\n                    map: null // TODO\n                },\n                head: result.title + result.head\n            };\n        },\n        $$render\n    };\n}\nfunction add_attribute(name, value, boolean) {\n    if (value == null || (boolean && !value))\n        return '';\n    return ` ${name}${value === true ? '' : `=${typeof value === 'string' ? JSON.stringify(escape(value)) : `\"${value}\"`}`}`;\n}\nfunction add_classes(classes) {\n    return classes ? ` class=\"${classes}\"` : '';\n}\n\nfunction bind(component, name, callback) {\n    const index = component.$$.props[name];\n    if (index !== undefined) {\n        component.$$.bound[index] = callback;\n        callback(component.$$.ctx[index]);\n    }\n}\nfunction create_component(block) {\n    block && block.c();\n}\nfunction claim_component(block, parent_nodes) {\n    block && block.l(parent_nodes);\n}\nfunction mount_component(component, target, anchor, customElement) {\n    const { fragment, on_mount, on_destroy, after_update } = component.$$;\n    fragment && fragment.m(target, anchor);\n    if (!customElement) {\n        // onMount happens before the initial afterUpdate\n        add_render_callback(() => {\n            const new_on_destroy = on_mount.map(run).filter(is_function);\n            if (on_destroy) {\n                on_destroy.push(...new_on_destroy);\n            }\n            else {\n                // Edge case - component was destroyed immediately,\n                // most likely as a result of a binding initialising\n                run_all(new_on_destroy);\n            }\n            component.$$.on_mount = [];\n        });\n    }\n    after_update.forEach(add_render_callback);\n}\nfunction destroy_component(component, detaching) {\n    const $$ = component.$$;\n    if ($$.fragment !== null) {\n        run_all($$.on_destroy);\n        $$.fragment && $$.fragment.d(detaching);\n        // TODO null out other refs, including component.$$ (but need to\n        // preserve final state?)\n        $$.on_destroy = $$.fragment = null;\n        $$.ctx = [];\n    }\n}\nfunction make_dirty(component, i) {\n    if (component.$$.dirty[0] === -1) {\n        dirty_components.push(component);\n        schedule_update();\n        component.$$.dirty.fill(0);\n    }\n    component.$$.dirty[(i / 31) | 0] |= (1 << (i % 31));\n}\nfunction init(component, options, instance, create_fragment, not_equal, props, dirty = [-1]) {\n    const parent_component = current_component;\n    set_current_component(component);\n    const $$ = component.$$ = {\n        fragment: null,\n        ctx: null,\n        // state\n        props,\n        update: noop,\n        not_equal,\n        bound: blank_object(),\n        // lifecycle\n        on_mount: [],\n        on_destroy: [],\n        on_disconnect: [],\n        before_update: [],\n        after_update: [],\n        context: new Map(parent_component ? parent_component.$$.context : []),\n        // everything else\n        callbacks: blank_object(),\n        dirty,\n        skip_bound: false\n    };\n    let ready = false;\n    $$.ctx = instance\n        ? instance(component, options.props || {}, (i, ret, ...rest) => {\n            const value = rest.length ? rest[0] : ret;\n            if ($$.ctx && not_equal($$.ctx[i], $$.ctx[i] = value)) {\n                if (!$$.skip_bound && $$.bound[i])\n                    $$.bound[i](value);\n                if (ready)\n                    make_dirty(component, i);\n            }\n            return ret;\n        })\n        : [];\n    $$.update();\n    ready = true;\n    run_all($$.before_update);\n    // `false` as a special case of no DOM component\n    $$.fragment = create_fragment ? create_fragment($$.ctx) : false;\n    if (options.target) {\n        if (options.hydrate) {\n            const nodes = children(options.target);\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.l(nodes);\n            nodes.forEach(detach);\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.c();\n        }\n        if (options.intro)\n            transition_in(component.$$.fragment);\n        mount_component(component, options.target, options.anchor, options.customElement);\n        flush();\n    }\n    set_current_component(parent_component);\n}\nlet SvelteElement;\nif (typeof HTMLElement === 'function') {\n    SvelteElement = class extends HTMLElement {\n        constructor() {\n            super();\n            this.attachShadow({ mode: 'open' });\n        }\n        connectedCallback() {\n            const { on_mount } = this.$$;\n            this.$$.on_disconnect = on_mount.map(run).filter(is_function);\n            // @ts-ignore todo: improve typings\n            for (const key in this.$$.slotted) {\n                // @ts-ignore todo: improve typings\n                this.appendChild(this.$$.slotted[key]);\n            }\n        }\n        attributeChangedCallback(attr, _oldValue, newValue) {\n            this[attr] = newValue;\n        }\n        disconnectedCallback() {\n            run_all(this.$$.on_disconnect);\n        }\n        $destroy() {\n            destroy_component(this, 1);\n            this.$destroy = noop;\n        }\n        $on(type, callback) {\n            // TODO should this delegate to addEventListener?\n            const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n            callbacks.push(callback);\n            return () => {\n                const index = callbacks.indexOf(callback);\n                if (index !== -1)\n                    callbacks.splice(index, 1);\n            };\n        }\n        $set($$props) {\n            if (this.$$set && !is_empty($$props)) {\n                this.$$.skip_bound = true;\n                this.$$set($$props);\n                this.$$.skip_bound = false;\n            }\n        }\n    };\n}\n/**\n * Base class for Svelte components. Used when dev=false.\n */\nclass SvelteComponent {\n    $destroy() {\n        destroy_component(this, 1);\n        this.$destroy = noop;\n    }\n    $on(type, callback) {\n        const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n        callbacks.push(callback);\n        return () => {\n            const index = callbacks.indexOf(callback);\n            if (index !== -1)\n                callbacks.splice(index, 1);\n        };\n    }\n    $set($$props) {\n        if (this.$$set && !is_empty($$props)) {\n            this.$$.skip_bound = true;\n            this.$$set($$props);\n            this.$$.skip_bound = false;\n        }\n    }\n}\n\nfunction dispatch_dev(type, detail) {\n    document.dispatchEvent(custom_event(type, Object.assign({ version: '3.35.0' }, detail)));\n}\nfunction append_dev(target, node) {\n    dispatch_dev('SvelteDOMInsert', { target, node });\n    append(target, node);\n}\nfunction insert_dev(target, node, anchor) {\n    dispatch_dev('SvelteDOMInsert', { target, node, anchor });\n    insert(target, node, anchor);\n}\nfunction detach_dev(node) {\n    dispatch_dev('SvelteDOMRemove', { node });\n    detach(node);\n}\nfunction detach_between_dev(before, after) {\n    while (before.nextSibling && before.nextSibling !== after) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction detach_before_dev(after) {\n    while (after.previousSibling) {\n        detach_dev(after.previousSibling);\n    }\n}\nfunction detach_after_dev(before) {\n    while (before.nextSibling) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction listen_dev(node, event, handler, options, has_prevent_default, has_stop_propagation) {\n    const modifiers = options === true ? ['capture'] : options ? Array.from(Object.keys(options)) : [];\n    if (has_prevent_default)\n        modifiers.push('preventDefault');\n    if (has_stop_propagation)\n        modifiers.push('stopPropagation');\n    dispatch_dev('SvelteDOMAddEventListener', { node, event, handler, modifiers });\n    const dispose = listen(node, event, handler, options);\n    return () => {\n        dispatch_dev('SvelteDOMRemoveEventListener', { node, event, handler, modifiers });\n        dispose();\n    };\n}\nfunction attr_dev(node, attribute, value) {\n    attr(node, attribute, value);\n    if (value == null)\n        dispatch_dev('SvelteDOMRemoveAttribute', { node, attribute });\n    else\n        dispatch_dev('SvelteDOMSetAttribute', { node, attribute, value });\n}\nfunction prop_dev(node, property, value) {\n    node[property] = value;\n    dispatch_dev('SvelteDOMSetProperty', { node, property, value });\n}\nfunction dataset_dev(node, property, value) {\n    node.dataset[property] = value;\n    dispatch_dev('SvelteDOMSetDataset', { node, property, value });\n}\nfunction set_data_dev(text, data) {\n    data = '' + data;\n    if (text.wholeText === data)\n        return;\n    dispatch_dev('SvelteDOMSetData', { node: text, data });\n    text.data = data;\n}\nfunction validate_each_argument(arg) {\n    if (typeof arg !== 'string' && !(arg && typeof arg === 'object' && 'length' in arg)) {\n        let msg = '{#each} only iterates over array-like objects.';\n        if (typeof Symbol === 'function' && arg && Symbol.iterator in arg) {\n            msg += ' You can use a spread to convert this iterable into an array.';\n        }\n        throw new Error(msg);\n    }\n}\nfunction validate_slots(name, slot, keys) {\n    for (const slot_key of Object.keys(slot)) {\n        if (!~keys.indexOf(slot_key)) {\n            console.warn(`<${name}> received an unexpected slot \"${slot_key}\".`);\n        }\n    }\n}\n/**\n * Base class for Svelte components with some minor dev-enhancements. Used when dev=true.\n */\nclass SvelteComponentDev extends SvelteComponent {\n    constructor(options) {\n        if (!options || (!options.target && !options.$$inline)) {\n            throw new Error(\"'target' is a required option\");\n        }\n        super();\n    }\n    $destroy() {\n        super.$destroy();\n        this.$destroy = () => {\n            console.warn('Component was already destroyed'); // eslint-disable-line no-console\n        };\n    }\n    $capture_state() { }\n    $inject_state() { }\n}\n/**\n * Base class to create strongly typed Svelte components.\n * This only exists for typing purposes and should be used in `.d.ts` files.\n *\n * ### Example:\n *\n * You have component library on npm called `component-library`, from which\n * you export a component called `MyComponent`. For Svelte+TypeScript users,\n * you want to provide typings. Therefore you create a `index.d.ts`:\n * ```ts\n * import { SvelteComponentTyped } from \"svelte\";\n * export class MyComponent extends SvelteComponentTyped<{foo: string}> {}\n * ```\n * Typing this makes it possible for IDEs like VS Code with the Svelte extension\n * to provide intellisense and to use the component like this in a Svelte file\n * with TypeScript:\n * ```svelte\n * <script lang=\"ts\">\n * \timport { MyComponent } from \"component-library\";\n * </script>\n * <MyComponent foo={'bar'} />\n * ```\n *\n * #### Why not make this part of `SvelteComponent(Dev)`?\n * Because\n * ```ts\n * class ASubclassOfSvelteComponent extends SvelteComponent<{foo: string}> {}\n * const component: typeof SvelteComponent = ASubclassOfSvelteComponent;\n * ```\n * will throw a type error, so we need to seperate the more strictly typed class.\n */\nclass SvelteComponentTyped extends SvelteComponentDev {\n    constructor(options) {\n        super(options);\n    }\n}\nfunction loop_guard(timeout) {\n    const start = Date.now();\n    return () => {\n        if (Date.now() - start > timeout) {\n            throw new Error('Infinite loop detected');\n        }\n    };\n}\n\nexport { HtmlTag, SvelteComponent, SvelteComponentDev, SvelteComponentTyped, SvelteElement, action_destroyer, add_attribute, add_classes, add_flush_callback, add_location, add_render_callback, add_resize_listener, add_transform, afterUpdate, append, append_dev, assign, attr, attr_dev, attribute_to_object, beforeUpdate, bind, binding_callbacks, blank_object, bubble, check_outros, children, claim_component, claim_element, claim_space, claim_text, clear_loops, component_subscribe, compute_rest_props, compute_slots, createEventDispatcher, create_animation, create_bidirectional_transition, create_component, create_in_transition, create_out_transition, create_slot, create_ssr_component, current_component, custom_event, dataset_dev, debug, destroy_block, destroy_component, destroy_each, detach, detach_after_dev, detach_before_dev, detach_between_dev, detach_dev, dirty_components, dispatch_dev, each, element, element_is, empty, escape, escaped, exclude_internal_props, fix_and_destroy_block, fix_and_outro_and_destroy_block, fix_position, flush, getContext, get_binding_group_value, get_current_component, get_custom_elements_slots, get_slot_changes, get_slot_context, get_spread_object, get_spread_update, get_store_value, globals, group_outros, handle_promise, hasContext, has_prop, identity, init, insert, insert_dev, intros, invalid_attribute_name_character, is_client, is_crossorigin, is_empty, is_function, is_promise, listen, listen_dev, loop, loop_guard, missing_component, mount_component, noop, not_equal, now, null_to_empty, object_without_properties, onDestroy, onMount, once, outro_and_destroy_block, prevent_default, prop_dev, query_selector_all, raf, run, run_all, safe_not_equal, schedule_update, select_multiple_value, select_option, select_options, select_value, self, setContext, set_attributes, set_current_component, set_custom_element_data, set_data, set_data_dev, set_input_type, set_input_value, set_now, set_raf, set_store_value, set_style, set_svg_attributes, space, spread, stop_propagation, subscribe, svg_element, text, tick, time_ranges_to_array, to_number, toggle_class, transition_in, transition_out, update_keyed_each, update_slot, update_slot_spread, validate_component, validate_each_argument, validate_each_keys, validate_slots, validate_store, xlink_attr };\n","<script>\n    import { onMount } from 'svelte';\nimport { CommandStack } from './command';\n    import { Point } from './geometry';\n    import { createModel, createLifeLine, createMessage, AddLifeLineCommand, AddMessageCommand } from './model';\n    import { Renderer } from './renderer';\n    import { DiagramContext, IdleState } from './states';\n\n    let width;\n    let height;\n    let context;\n\n    let model;\n    let commandStack;\n    let renderer;\n    let state;\n    let diagramContext;\n\n    let view = {\n        lifeLines: [],\n        messages: [],\n        pendingMessage: null\n    };\n    let paletteState = {\n        canUndo: false,\n        canRedo: false\n    }\n\n    const style = {\n        lifeLineHeadTextSize: \"24px\",\n        lifeLineHeadMargin: 10,\n        minHeadHeight: 60,\n        topMargin: 20,\n        leftMargin: 20,\n        minHeadGap: 20,\n        messageTextSize: \"18px\",\n        messageStartGap: 80,\n        messageGap: 60,\n        messageMargin: 15\n    };\n\n    onMount(() => {\n        const canvas = document.createElement(\"canvas\");\n        context = canvas.getContext(\"2d\");\n\n        model = createModel();\n\n        renderer = new Renderer(style, {\n            measure: measureText\n        });\n\n        commandStack = new CommandStack();\n\n        diagramContext = new DiagramContext(commandStack, model, renderer, (v) => {\n            view = v;\n            paletteState = {\n                canUndo: commandStack.canUndo(),\n                canRedo: commandStack.canRedo()\n            };\n        });\n        \n        state = new IdleState(diagramContext);\n\n        diagramContext.refresh(true);\n    });\n    \n    function measureText(text, textSize) {\n        context.font = textSize + \" arial\";\n        const metrics = context.measureText(text);\n        return metrics;\n    }\n\n    function mouseDown(e) {\n        const mousePoint = new Point(e.clientX, e.clientY)\n        state = state.mouseDown(mousePoint);\n    }\n\n    function mouseUp(e) {\n        const mousePoint = new Point(e.clientX, e.clientY)\n        state = state.mouseUp(mousePoint);\n    }\n\n    function mouseMove(e) {\n        const mousePoint = new Point(e.clientX, e.clientY)\n        state = state.mouseMove(mousePoint);\n    }\n\n    function undoAction() {\n        commandStack.undo();\n        diagramContext.refresh(true);\n    }\n\n    function redoAction() {\n        commandStack.redo();\n        diagramContext.refresh(true);\n    }\n\n    function addLifeLineAction() {\n        commandStack.execute(new AddLifeLineCommand(model, createLifeLine()));\n        diagramContext.refresh(true);\n    }\n\n    function addMessageAction() {\n        if (model.lifeLines.length >= 2) {\n            commandStack.execute(new AddMessageCommand(model, createMessage(model.lifeLines)));\n            diagramContext.refresh(true);\n        }\n    }\n\n</script>\n\n<div class=\"container\" bind:clientWidth={width} bind:clientHeight={height}>\n    <div on:mousedown={mouseDown} on:mouseup={mouseUp} on:mousemove={mouseMove}>\n    <svg {width} {height} viewBox=\"0 0 {width} {height}\">\n        <defs>\n            <marker id=\"triangle\" viewBox=\"0 0 10 10\"\n                  refX=\"10\" refY=\"5\"\n                  markerUnits=\"strokeWidth\"\n                  markerWidth=\"10\" markerHeight=\"10\"\n                  orient=\"auto-start-reverse\">\n                <path d=\"M 0 0 L 10 5 L 0 10 z\" fill=\"black\"/>\n            </marker>\n        </defs>\n        <style>\n            .select-marker {\n                stroke: none;\n            }\n            .select-marker.hover {\n                stroke: #55CCFF;\n            }\n            .select-marker.selected {\n                stroke: #55CC99;\n            }\n            .point-marker {\n                fill: none;\n            }\n            .point-marker.hover {\n                fill: #55CCFF;\n            }\n        </style>\n        {#each view.lifeLines as lifeLine}\n        <g transform=\"translate({lifeLine.x},{lifeLine.y})\">\n            <rect width=\"{lifeLine.width}\" height=\"{lifeLine.headHeight}\" stroke=\"black\" fill=\"none\"/>\n            <text dx={lifeLine.width/2} dy={lifeLine.headHeight/2+10} text-anchor=\"middle\" font-size=\"{lifeLine.textSize}\">{lifeLine.text}</text>\n            <line x1={lifeLine.width/2} y1={lifeLine.headHeight}\n                x2={lifeLine.width/2} y2={lifeLine.headHeight + lifeLine.lineHeight}\n                stroke-dasharray=\"4\"\n                stroke=\"black\"/>\n            <rect class=\"select-marker\" class:hover={lifeLine.hover} x={-10} y={-10}\n                    width={lifeLine.markerBounds.width} height={lifeLine.markerBounds.height}\n                    rx=\"10\" ry=\"10\"\n                    fill=\"none\" stroke-dasharray=\"4\" stroke-width=\"2\"/>\n        </g>\n        {/each}\n        \n        {#each view.messages as message}\n        {#if !message.editing}\n        <g>\n            <line x1={message.from.lifeLine.centerX()} y1={message.y}\n                x2={message.to.lifeLine.centerX()} y2={message.y} stroke=\"black\" marker-end=\"url(#triangle)\"/>\n            {#if message.reversed}\n            <text x={message.to.lifeLine.centerX()+style.messageMargin} y={message.y-7} text-anchor=\"start\" font-size=\"{message.textSize}\">{message.text}</text>\n            {:else}\n            <text x={message.to.lifeLine.centerX()-style.messageMargin} y={message.y-7} text-anchor=\"end\" font-size=\"{message.textSize}\">{message.text}</text>\n            {/if}\n            <circle class=\"point-marker\" class:hover={message.from.hover}\n                cx={message.from.center().x} cy={message.from.center().y} r=\"6\" />\n            <circle class=\"point-marker\" class:hover={message.to.hover}\n                cx={message.to.center().x} cy={message.to.center().y} r=\"6\" />\n            <rect class=\"select-marker\" class:hover={!message.selected && message.hover} class:selected={message.selected}\n                    x={message.markerBounds.x} y={message.markerBounds.y}\n                    width={message.markerBounds.width} height={message.markerBounds.height}\n                    rx=\"10\" ry=\"10\" fill=\"none\" stroke-dasharray=\"4\" stroke-width=\"2\" />\n        </g>\n        {/if}\n        {/each}\n        {#if view.pendingMessage}\n        <line x1={view.pendingMessage.from} y1={view.pendingMessage.y}\n                x2={view.pendingMessage.to} y2={view.pendingMessage.y} fill=\"none\" stroke=\"black\" marker-end=\"url(#triangle)\" />\n            {#if view.pendingMessage.hoverOther}\n            <circle class=\"point-marker hover\" cx={view.pendingMessage.hoverOther.centerX()} cy={view.pendingMessage.y} r=\"6\" />\n            {/if}\n        {/if}\n        {#if view.pendingLifeLine}\n        <line x1={view.pendingLifeLine.x} y1={view.pendingLifeLine.y}\n            x2={view.pendingLifeLine.x} y2={view.pendingLifeLine.y + view.pendingLifeLine.height}\n            stroke-dasharray=\"4\"\n            stroke-width={view.pendingLifeLine.snap ? 3 : 1}\n            stroke={view.pendingLifeLine.snap ? \"green\" : \"#55CCFF\"}/>\n        {/if}\n    </svg>\n    </div>\n    <div class=\"palette\">\n        <ul>\n            <li>\n                <button disabled={!paletteState.canUndo} on:click={undoAction}>Undo</button>\n            </li>\n            <li>\n                <button disabled={!paletteState.canRedo} on:click={redoAction}>Redo</button>\n            </li>\n            <li class=\"spacer\">\n                <button on:click={addLifeLineAction}>Add LifeLine</button>\n            </li>\n            <li>\n                <button on:click={addMessageAction}>Add Message</button>\n            </li>\n        </ul>\n    </div>\n</div>\n\n<style>\n    div.container {\n        position: relative;\n        width: 100%;\n        height: 100%;\n        overflow: hidden;\n        font-family: Arial, Helvetica, sans-serif;\n    }\n\n    div.palette {\n        position: absolute;\n        bottom: 20px;\n        left: 100px;\n        /* border: 1px solid black; */\n        border-radius: 5px;\n        background: white;\n        box-shadow: 2px 2px 5px gray;\n    }\n\n    .palette ul {\n        padding: 0px;\n        margin: 10px;\n    }\n\n    .palette li {\n        display: inline-block;\n    }\n\n    li.spacer {\n        margin-left: 10px;\n    }\n</style>\n","\nimport App from './App.svelte';\n\nconst app = new App({\n    target: document.body\n});"],"sourceRoot":""}