(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function s(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=s(n);fetch(n.href,r)}})();const es=!1;var Dt=Array.isArray,fi=Array.prototype.indexOf,At=Array.from,Lt=Object.defineProperty,Ee=Object.getOwnPropertyDescriptor,ms=Object.getOwnPropertyDescriptors,ui=Object.prototype,di=Array.prototype,Ot=Object.getPrototypeOf,ts=Object.isExtensible;function vi(t){return t()}function Et(t){for(var e=0;e<t.length;e++)t[e]()}function gi(){var t,e,s=new Promise((i,n)=>{t=i,e=n});return{promise:s,resolve:t,reject:e}}const V=2,Pt=4,dt=8,qe=16,te=32,He=64,_s=128,I=256,st=512,H=1024,U=2048,he=4096,q=8192,_e=16384,Nt=32768,Rt=65536,ss=1<<17,mi=1<<18,Bt=1<<19,Ft=1<<20,bt=1<<21,It=1<<22,de=1<<23,ve=Symbol("$state"),_i=Symbol("legacy props"),pi=Symbol(""),Ut=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function wi(){throw new Error("https://svelte.dev/e/await_outside_boundary")}function xi(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function yi(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Si(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Li(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Ei(t){throw new Error("https://svelte.dev/e/effect_orphan")}function bi(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Mi(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function ki(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Hi(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Ci(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}const Ti=1,Di=2,Ai=16,Oi=2,Pi=4,Ni=8,Ri=1,Bi=2,T=Symbol(),Fi="http://www.w3.org/1999/xhtml";let Ii=!1;function ps(t){return t===this.v}function Ui(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function ws(t){return!Ui(t,this.v)}let Ce=!1,Vi=!1;function zi(){Ce=!0}let E=null;function it(t){E=t}function Vt(t,e=!1,s){E={p:E,c:null,e:null,s:t,x:null,l:Ce&&!e?{s:null,u:null,$:[]}:null}}function zt(t){var e=E,s=e.e;if(s!==null){e.e=null;for(var i of s)Ds(i)}return E=e.p,{}}function Ye(){return!Ce||E!==null&&E.l===null}const ji=new WeakMap;function Xi(t){var e=x;if(e===null)return S.f|=de,t;if((e.f&Nt)===0){if((e.f&_s)===0)throw!e.parent&&t instanceof Error&&xs(t),t;e.b.error(t)}else jt(t,e)}function jt(t,e){for(;e!==null;){if((e.f&_s)!==0)try{e.b.error(t);return}catch{}e=e.parent}throw t instanceof Error&&xs(t),t}function xs(t){const e=ji.get(t);e&&(Lt(t,"message",{value:e.message}),Lt(t,"stack",{value:e.stack}))}let nt=[];function qi(){var t=nt;nt=[],Et(t)}function ys(t){nt.length===0&&queueMicrotask(qi),nt.push(t)}function Yi(){for(var t=x.b;t!==null&&!t.has_pending_snippet();)t=t.parent;return t===null&&wi(),t}function Xt(t){var e=V|U,s=S!==null&&(S.f&V)!==0?S:null;return x===null||s!==null&&(s.f&I)!==0?e|=I:x.f|=Bt,{ctx:E,deps:null,effects:null,equals:ps,f:e,fn:t,reactions:null,rv:0,v:T,wv:0,parent:s??x,ac:null}}function Gi(t,e){let s=x;s===null&&yi();var i=s.b,n=void 0,r=Ie(T),a=null,h=!S;return on(()=>{try{var o=t()}catch(u){o=Promise.reject(u)}var l=()=>o;n=a?.then(l,l)??Promise.resolve(o),a=n;var c=F,d=i.pending;h&&(i.update_pending_count(1),d||c.increment());const f=(u,v=void 0)=>{a=null,d||c.activate(),v?v!==Ut&&(r.f|=de,at(r,v)):((r.f&de)!==0&&(r.f^=de),at(r,u)),h&&(i.update_pending_count(-1),d||c.decrement()),Es()};if(n.then(f,u=>f(null,u||"unknown")),c)return()=>{queueMicrotask(()=>c.neuter())}}),new Promise(o=>{function l(c){function d(){c===n?o(r):l(n)}c.then(d,d)}l(n)})}function qt(t){const e=Xt(t);return e.equals=ws,e}function Ss(t){var e=t.effects;if(e!==null){t.effects=null;for(var s=0;s<e.length;s+=1)Q(e[s])}}function Wi(t){for(var e=t.parent;e!==null;){if((e.f&V)===0)return e;e=e.parent}return null}function Yt(t){var e,s=x;le(Wi(t));try{Ss(t),e=Us(t)}finally{le(s)}return e}function Ls(t){var e=Yt(t);if(t.equals(e)||(t.v=e,t.wv=Fs()),!pe)if(ke!==null)ke.set(t,t.v);else{var s=(ae||(t.f&I)!==0)&&t.deps!==null?he:H;C(t,s)}}function $i(t,e,s){const i=Ye()?Xt:qt;if(e.length===0){s(t.map(i));return}var n=F,r=x,a=Ki(),h=Yi();Promise.all(e.map(o=>Gi(o))).then(o=>{n?.activate(),a();try{s([...t.map(i),...o])}catch(l){(r.f&_e)===0&&jt(l,r)}n?.deactivate(),Es()}).catch(o=>{h.error(o)})}function Ki(){var t=x,e=S,s=E;return function(){le(t),W(e),it(s)}}function Es(){le(null),W(null),it(null)}const Ke=new Set;let F=null,ke=null;let Re=[],rt=null,Mt=!1;class vt{#l=new Map;#r=new Map;#a=new Set;#t=0;#h=null;#c=!1;#i=[];#o=[];#s=[];#e=[];#n=[];skipped_effects=new Set;#u(e){Re=[];var s=null;if(Ke.size>1){s=new Map,ke=new Map;for(const[r,a]of this.#l)s.set(r,{v:r.v,wv:r.wv}),r.v=a;for(const r of Ke)if(r!==this)for(const[a,h]of r.#r)s.has(a)||(s.set(a,{v:a.v,wv:a.wv}),a.v=h)}for(const r of e)this.#d(r);if(this.#i.length===0&&this.#t===0){var i=this.#s,n=this.#e;this.#s=[],this.#e=[],this.#n=[],this.#f(),is(i),is(n),this.#h?.resolve()}else{for(const r of this.#s)C(r,H);for(const r of this.#e)C(r,H);for(const r of this.#n)C(r,H)}if(s){for(const[r,{v:a,wv:h}]of s)r.wv<=h&&(r.v=a);ke=null}for(const r of this.#i)Me(r);for(const r of this.#o)Me(r);this.#i=[],this.#o=[]}#d(e){e.f^=H;for(var s=e.first;s!==null;){var i=s.f,n=(i&(te|He))!==0,r=n&&(i&H)!==0,a=r||(i&q)!==0||this.skipped_effects.has(s);if(!a&&s.fn!==null){if(n)s.f^=H;else if((i&Pt)!==0)this.#e.push(s);else if(Ge(s))if((i&It)!==0){var h=s.b?.pending?this.#o:this.#i;h.push(s)}else(s.f&qe)!==0&&this.#n.push(s),Me(s);var o=s.first;if(o!==null){s=o;continue}}var l=s.parent;for(s=s.next;s===null&&l!==null;)s=l.next,l=l.parent}}capture(e,s){this.#r.has(e)||this.#r.set(e,s),this.#l.set(e,e.v)}activate(){F=this}deactivate(){F=null}neuter(){this.#c=!0}flush(){Re.length>0?this.flush_effects():this.#f(),F===this&&(this.#t===0&&Ke.delete(this),F=null)}flush_effects(){var e=be;Mt=!0;try{var s=0;for(as(!0);Re.length>0;)s++>1e3&&Ji(),this.#u(Re),ge.clear()}finally{Mt=!1,as(e),rt=null}}#f(){if(!this.#c)for(const e of this.#a)e();this.#a.clear()}increment(){this.#t+=1}decrement(){if(this.#t-=1,this.#t===0){for(const e of this.#s)C(e,U),oe(e);for(const e of this.#e)C(e,U),oe(e);for(const e of this.#n)C(e,U),oe(e);this.#s=[],this.#e=[],this.flush()}}add_callback(e){this.#a.add(e)}settled(){return(this.#h??=gi()).promise}static ensure(){if(F===null){const e=F=new vt;Ke.add(F),queueMicrotask(()=>{F===e&&e.flush()})}return F}}function Ji(){try{bi()}catch(t){if(rt!==null)jt(t,rt);else throw t}}function is(t){var e=t.length;if(e!==0){for(var s=0;s<e;s++){var i=t[s];if((i.f&(_e|q))===0&&Ge(i)){var n=ot;if(Me(i),i.deps===null&&i.first===null&&i.nodes_start===null&&(i.teardown===null?Ns(i):i.fn=null),ot>n&&(i.f&Ft)!==0)break}}for(;s<e;s+=1)oe(t[s])}}function oe(t){for(var e=rt=t;e.parent!==null;){e=e.parent;var s=e.f;if(Mt&&e===x&&(s&qe)!==0)return;if((s&(He|te))!==0){if((s&H)===0)return;e.f^=H}}Re.push(e)}const ge=new Map;function Ie(t,e){var s={f:0,v:t,reactions:null,equals:ps,rv:0,wv:0};return s}function ie(t,e){const s=Ie(t);return cn(s),s}function re(t,e=!1,s=!0){const i=Ie(t);return e||(i.equals=ws),Ce&&s&&E!==null&&E.l!==null&&(E.l.s??=[]).push(i),i}function A(t,e,s=!1){S!==null&&(!G||(S.f&ss)!==0)&&Ye()&&(S.f&(V|qe|It|ss))!==0&&!J?.includes(t)&&Ci();let i=s?Se(e):e;return at(t,i)}function at(t,e){if(!t.equals(e)){var s=t.v;pe?ge.set(t,e):ge.set(t,s),t.v=e,vt.ensure().capture(t,s),(t.f&V)!==0&&((t.f&U)!==0&&Yt(t),C(t,(t.f&I)===0?H:he)),t.wv=Fs(),bs(t,U),Ye()&&x!==null&&(x.f&H)!==0&&(x.f&(te|He))===0&&(j===null?fn([t]):j.push(t))}return e}function _t(t){A(t,t.v+1)}function bs(t,e){var s=t.reactions;if(s!==null)for(var i=Ye(),n=s.length,r=0;r<n;r++){var a=s[r],h=a.f;(h&U)===0&&(!i&&a===x||(C(a,e),(h&(H|I))!==0&&((h&V)!==0?bs(a,he):oe(a))))}}function Se(t){if(typeof t!="object"||t===null||ve in t)return t;const e=Ot(t);if(e!==ui&&e!==di)return t;var s=new Map,i=Dt(t),n=ie(0),r=me,a=h=>{if(me===r)return h();var o=S,l=me;W(null),ls(r);var c=h();return W(o),ls(l),c};return i&&s.set("length",ie(t.length)),new Proxy(t,{defineProperty(h,o,l){(!("value"in l)||l.configurable===!1||l.enumerable===!1||l.writable===!1)&&ki();var c=s.get(o);return c===void 0?c=a(()=>{var d=ie(l.value);return s.set(o,d),d}):A(c,l.value,!0),!0},deleteProperty(h,o){var l=s.get(o);if(l===void 0){if(o in h){const f=a(()=>ie(T));s.set(o,f),_t(n)}}else{if(i&&typeof o=="string"){var c=s.get("length"),d=Number(o);Number.isInteger(d)&&d<c.v&&A(c,d)}A(l,T),_t(n)}return!0},get(h,o,l){if(o===ve)return t;var c=s.get(o),d=o in h;if(c===void 0&&(!d||Ee(h,o)?.writable)&&(c=a(()=>{var u=Se(d?h[o]:T),v=ie(u);return v}),s.set(o,c)),c!==void 0){var f=g(c);return f===T?void 0:f}return Reflect.get(h,o,l)},getOwnPropertyDescriptor(h,o){var l=Reflect.getOwnPropertyDescriptor(h,o);if(l&&"value"in l){var c=s.get(o);c&&(l.value=g(c))}else if(l===void 0){var d=s.get(o),f=d?.v;if(d!==void 0&&f!==T)return{enumerable:!0,configurable:!0,value:f,writable:!0}}return l},has(h,o){if(o===ve)return!0;var l=s.get(o),c=l!==void 0&&l.v!==T||Reflect.has(h,o);if(l!==void 0||x!==null&&(!c||Ee(h,o)?.writable)){l===void 0&&(l=a(()=>{var f=c?Se(h[o]):T,u=ie(f);return u}),s.set(o,l));var d=g(l);if(d===T)return!1}return c},set(h,o,l,c){var d=s.get(o),f=o in h;if(i&&o==="length")for(var u=l;u<d.v;u+=1){var v=s.get(u+"");v!==void 0?A(v,T):u in h&&(v=a(()=>ie(T)),s.set(u+"",v))}if(d===void 0)(!f||Ee(h,o)?.writable)&&(d=a(()=>ie(void 0)),A(d,Se(l)),s.set(o,d));else{f=d.v!==T;var m=a(()=>Se(l));A(d,m)}var y=Reflect.getOwnPropertyDescriptor(h,o);if(y?.set&&y.set.call(c,l),!f){if(i&&typeof o=="string"){var L=s.get("length"),_=Number(o);Number.isInteger(_)&&_>=L.v&&A(L,_+1)}_t(n)}return!0},ownKeys(h){g(n);var o=Reflect.ownKeys(h).filter(d=>{var f=s.get(d);return f===void 0||f.v!==T});for(var[l,c]of s)c.v!==T&&!(l in h)&&o.push(l);return o},setPrototypeOf(){Hi()}})}var ns,Ms,ks,Hs;function Zi(){if(ns===void 0){ns=window,Ms=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,s=Text.prototype;ks=Ee(e,"firstChild").get,Hs=Ee(e,"nextSibling").get,ts(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),ts(s)&&(s.__t=void 0)}}function gt(t=""){return document.createTextNode(t)}function ne(t){return ks.call(t)}function mt(t){return Hs.call(t)}function z(t,e){return ne(t)}function rs(t,e){{var s=ne(t);return s instanceof Comment&&s.data===""?mt(s):s}}function et(t,e=1,s=!1){let i=t;for(;e--;)i=mt(i);return i}function Qi(t){t.textContent=""}function Cs(){return!1}function Ts(t){x===null&&S===null&&Ei(),S!==null&&(S.f&I)!==0&&x===null&&Li(),pe&&Si()}function en(t,e){var s=e.last;s===null?e.last=e.first=t:(s.next=t,t.prev=s,e.last=t)}function $(t,e,s,i=!0){var n=x;n!==null&&(n.f&q)!==0&&(t|=q);var r={ctx:E,deps:null,nodes_start:null,nodes_end:null,f:t|U,first:null,fn:e,last:null,next:null,parent:n,b:n&&n.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(s)try{Me(r),r.f|=Nt}catch(o){throw Q(r),o}else e!==null&&oe(r);var a=s&&r.deps===null&&r.first===null&&r.nodes_start===null&&r.teardown===null&&(r.f&Bt)===0;if(!a&&i&&(n!==null&&en(r,n),S!==null&&(S.f&V)!==0)){var h=S;(h.effects??=[]).push(r)}return r}function tn(t){const e=$(dt,null,!1);return C(e,H),e.teardown=t,e}function kt(t){Ts();var e=x.f,s=!S&&(e&te)!==0&&(e&Nt)===0;if(s){var i=E;(i.e??=[]).push(t)}else return Ds(t)}function Ds(t){return $(Pt|Ft,t,!1)}function sn(t){return Ts(),$(dt|Ft,t,!0)}function nn(t){vt.ensure();const e=$(He,t,!0);return(s={})=>new Promise(i=>{s.outro?Wt(e,()=>{Q(e),i(void 0)}):(Q(e),i(void 0))})}function rn(t){return $(Pt,t,!1)}function Je(t,e){var s=E,i={effect:null,ran:!1,deps:t};s.l.$.push(i),i.effect=Gt(()=>{t(),!i.ran&&(i.ran=!0,k(e))})}function an(){var t=E;Gt(()=>{for(var e of t.l.$){e.deps();var s=e.effect;(s.f&H)!==0&&C(s,he),Ge(s)&&Me(s),e.ran=!1}})}function on(t){return $(It|Bt,t,!0)}function Gt(t,e=0){return $(dt|e,t,!0)}function Fe(t,e=[],s=[]){$i(e,s,i=>{$(dt,()=>t(...i.map(g)),!0)})}function As(t,e=0){var s=$(qe|e,t,!0);return s}function Ue(t,e=!0){return $(te,t,!0,e)}function Os(t){var e=t.teardown;if(e!==null){const s=pe,i=S;os(!0),W(null);try{e.call(null)}finally{os(s),W(i)}}}function Ps(t,e=!1){var s=t.first;for(t.first=t.last=null;s!==null;){s.ac?.abort(Ut);var i=s.next;(s.f&He)!==0?s.parent=null:Q(s,e),s=i}}function ln(t){for(var e=t.first;e!==null;){var s=e.next;(e.f&te)===0&&Q(e),e=s}}function Q(t,e=!0){var s=!1;(e||(t.f&mi)!==0)&&t.nodes_start!==null&&t.nodes_end!==null&&(hn(t.nodes_start,t.nodes_end),s=!0),Ps(t,e&&!s),lt(t,0),C(t,_e);var i=t.transitions;if(i!==null)for(const r of i)r.stop();Os(t);var n=t.parent;n!==null&&n.first!==null&&Ns(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=t.ac=null}function hn(t,e){for(;t!==null;){var s=t===e?null:mt(t);t.remove(),t=s}}function Ns(t){var e=t.parent,s=t.prev,i=t.next;s!==null&&(s.next=i),i!==null&&(i.prev=s),e!==null&&(e.first===t&&(e.first=i),e.last===t&&(e.last=s))}function Wt(t,e){var s=[];$t(t,s,!0),Rs(s,()=>{Q(t),e&&e()})}function Rs(t,e){var s=t.length;if(s>0){var i=()=>--s||e();for(var n of t)n.out(i)}else e()}function $t(t,e,s){if((t.f&q)===0){if(t.f^=q,t.transitions!==null)for(const a of t.transitions)(a.is_global||s)&&e.push(a);for(var i=t.first;i!==null;){var n=i.next,r=(i.f&Rt)!==0||(i.f&te)!==0;$t(i,e,r?s:!1),i=n}}}function Kt(t){Bs(t,!0)}function Bs(t,e){if((t.f&q)!==0){t.f^=q,(t.f&H)===0&&(C(t,U),oe(t));for(var s=t.first;s!==null;){var i=s.next,n=(s.f&Rt)!==0||(s.f&te)!==0;Bs(s,n?e:!1),s=i}if(t.transitions!==null)for(const r of t.transitions)(r.is_global||e)&&r.in()}}let be=!1;function as(t){be=t}let pe=!1;function os(t){pe=t}let S=null,G=!1;function W(t){S=t}let x=null;function le(t){x=t}let J=null;function cn(t){S!==null&&(J===null?J=[t]:J.push(t))}let P=null,B=0,j=null;function fn(t){j=t}let ot=1,Ve=0,me=Ve;function ls(t){me=t}let ae=!1;function Fs(){return++ot}function Ge(t){var e=t.f;if((e&U)!==0)return!0;if((e&he)!==0){var s=t.deps,i=(e&I)!==0;if(s!==null){var n,r,a=(e&st)!==0,h=i&&x!==null&&!ae,o=s.length;if((a||h)&&(x===null||(x.f&_e)===0)){var l=t,c=l.parent;for(n=0;n<o;n++)r=s[n],(a||!r?.reactions?.includes(l))&&(r.reactions??=[]).push(l);a&&(l.f^=st),h&&c!==null&&(c.f&I)===0&&(l.f^=I)}for(n=0;n<o;n++)if(r=s[n],Ge(r)&&Ls(r),r.wv>t.wv)return!0}(!i||x!==null&&!ae)&&C(t,H)}return!1}function Is(t,e,s=!0){var i=t.reactions;if(i!==null&&!J?.includes(t))for(var n=0;n<i.length;n++){var r=i[n];(r.f&V)!==0?Is(r,e,!1):e===r&&(s?C(r,U):(r.f&H)!==0&&C(r,he),oe(r))}}function Us(t){var e=P,s=B,i=j,n=S,r=ae,a=J,h=E,o=G,l=me,c=t.f;P=null,B=0,j=null,ae=(c&I)!==0&&(G||!be||S===null),S=(c&(te|He))===0?t:null,J=null,it(t.ctx),G=!1,me=++Ve,t.ac!==null&&(t.ac.abort(Ut),t.ac=null);try{t.f|=bt;var d=(0,t.fn)(),f=t.deps;if(P!==null){var u;if(lt(t,B),f!==null&&B>0)for(f.length=B+P.length,u=0;u<P.length;u++)f[B+u]=P[u];else t.deps=f=P;if(!ae||(c&V)!==0&&t.reactions!==null)for(u=B;u<f.length;u++)(f[u].reactions??=[]).push(t)}else f!==null&&B<f.length&&(lt(t,B),f.length=B);if(Ye()&&j!==null&&!G&&f!==null&&(t.f&(V|he|U))===0)for(u=0;u<j.length;u++)Is(j[u],t);return n!==null&&n!==t&&(Ve++,j!==null&&(i===null?i=j:i.push(...j))),(t.f&de)!==0&&(t.f^=de),d}catch(v){return Xi(v)}finally{t.f^=bt,P=e,B=s,j=i,S=n,ae=r,J=a,it(h),G=o,me=l}}function un(t,e){let s=e.reactions;if(s!==null){var i=fi.call(s,t);if(i!==-1){var n=s.length-1;n===0?s=e.reactions=null:(s[i]=s[n],s.pop())}}s===null&&(e.f&V)!==0&&(P===null||!P.includes(e))&&(C(e,he),(e.f&(I|st))===0&&(e.f^=st),Ss(e),lt(e,0))}function lt(t,e){var s=t.deps;if(s!==null)for(var i=e;i<s.length;i++)un(t,s[i])}function Me(t){var e=t.f;if((e&_e)===0){C(t,H);var s=x,i=be;x=t,be=!0;try{(e&qe)!==0?ln(t):Ps(t),Os(t);var n=Us(t);t.teardown=typeof n=="function"?n:null,t.wv=ot;var r;es&&Vi&&(t.f&U)!==0&&t.deps}finally{be=i,x=s}}}function g(t){var e=t.f,s=(e&V)!==0;if(S!==null&&!G){var i=x!==null&&(x.f&_e)!==0;if(!i&&!J?.includes(t)){var n=S.deps;if((S.f&bt)!==0)t.rv<Ve&&(t.rv=Ve,P===null&&n!==null&&n[B]===t?B++:P===null?P=[t]:(!ae||!P.includes(t))&&P.push(t));else{(S.deps??=[]).push(t);var r=t.reactions;r===null?t.reactions=[S]:r.includes(S)||r.push(S)}}}else if(s&&t.deps===null&&t.effects===null){var a=t,h=a.parent;h!==null&&(h.f&I)===0&&(a.f^=I)}if(pe){if(ge.has(t))return ge.get(t);if(s){a=t;var o=a.v;return((a.f&H)!==0||Vs(a))&&(o=Yt(a)),ge.set(a,o),o}}else if(s){if(a=t,ke?.has(a))return ke.get(a);Ge(a)&&Ls(a)}if((t.f&de)!==0)throw t.v;return t.v}function Vs(t){if(t.v===T)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(ge.has(e)||(e.f&V)!==0&&Vs(e))return!0;return!1}function k(t){var e=G;try{return G=!0,t()}finally{G=e}}const dn=-7169;function C(t,e){t.f=t.f&dn|e}function O(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(ve in t)Ht(t);else if(!Array.isArray(t))for(let e in t){const s=t[e];typeof s=="object"&&s&&ve in s&&Ht(s)}}}function Ht(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let i in t)try{Ht(t[i],e)}catch{}const s=Ot(t);if(s!==Object.prototype&&s!==Array.prototype&&s!==Map.prototype&&s!==Set.prototype&&s!==Date.prototype){const i=ms(s);for(let n in i){const r=i[n].get;if(r)try{r.call(t)}catch{}}}}}const vn=["touchstart","touchmove"];function gn(t){return vn.includes(t)}function mn(t){var e=S,s=x;W(null),le(null);try{return t()}finally{W(e),le(s)}}const _n=new Set,hs=new Set;function pn(t,e,s,i={}){function n(r){if(i.capture||Be.call(e,r),!r.cancelBubble)return mn(()=>s?.call(this,r))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?ys(()=>{e.addEventListener(t,n,i)}):e.addEventListener(t,n,i),n}function pt(t,e,s,i,n){var r={capture:i,passive:n},a=pn(t,e,s,r);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&tn(()=>{e.removeEventListener(t,a,r)})}function Be(t){var e=this,s=e.ownerDocument,i=t.type,n=t.composedPath?.()||[],r=n[0]||t.target,a=0,h=t.__root;if(h){var o=n.indexOf(h);if(o!==-1&&(e===document||e===window)){t.__root=e;return}var l=n.indexOf(e);if(l===-1)return;o<=l&&(a=o)}if(r=n[a]||t.target,r!==e){Lt(t,"currentTarget",{configurable:!0,get(){return r||s}});var c=S,d=x;W(null),le(null);try{for(var f,u=[];r!==null;){var v=r.assignedSlot||r.parentNode||r.host||null;try{var m=r["__"+i];if(m!=null&&(!r.disabled||t.target===r))if(Dt(m)){var[y,...L]=m;y.apply(r,[t,...L])}else m.call(r,t)}catch(_){f?u.push(_):f=_}if(t.cancelBubble||v===e||v===null)break;r=v}if(f){for(let _ of u)queueMicrotask(()=>{throw _});throw f}}finally{t.__root=e,delete t.currentTarget,W(c),le(d)}}}function zs(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function ht(t,e){var s=x;s.nodes_start===null&&(s.nodes_start=t,s.nodes_end=e)}function js(t,e){var s=(e&Bi)!==0,i,n=!t.startsWith("<!>");return()=>{i===void 0&&(i=zs(n?t:"<!>"+t),i=ne(i));var r=s||Ms?document.importNode(i,!0):i.cloneNode(!0);return ht(r,r),r}}function wn(t,e,s="svg"){var i=!t.startsWith("<!>"),n=(e&Ri)!==0,r=`<${s}>${i?t:"<!>"+t}</${s}>`,a;return()=>{if(!a){var h=zs(r),o=ne(h);if(n)for(a=document.createDocumentFragment();ne(o);)a.appendChild(ne(o));else a=ne(o)}var l=a.cloneNode(!0);if(n){var c=ne(l),d=l.lastChild;ht(c,d)}else ht(l,l);return l}}function Jt(t,e){return wn(t,e,"svg")}function xn(){var t=document.createDocumentFragment(),e=document.createComment(""),s=gt();return t.append(e,s),ht(e,s),t}function Le(t,e){t!==null&&t.before(e)}function yn(t,e){var s=e==null?"":typeof e=="object"?e+"":e;s!==(t.__t??=t.nodeValue)&&(t.__t=s,t.nodeValue=s+"")}function Sn(t,e){return Ln(t,e)}const ye=new Map;function Ln(t,{target:e,anchor:s,props:i={},events:n,context:r,intro:a=!0}){Zi();var h=new Set,o=d=>{for(var f=0;f<d.length;f++){var u=d[f];if(!h.has(u)){h.add(u);var v=gn(u);e.addEventListener(u,Be,{passive:v});var m=ye.get(u);m===void 0?(document.addEventListener(u,Be,{passive:v}),ye.set(u,1)):ye.set(u,m+1)}}};o(At(_n)),hs.add(o);var l=void 0,c=nn(()=>{var d=s??e.appendChild(gt());return Ue(()=>{if(r){Vt({});var f=E;f.c=r}n&&(i.$$events=n),l=t(d,i)||{},r&&zt()}),()=>{for(var f of h){e.removeEventListener(f,Be);var u=ye.get(f);--u===0?(document.removeEventListener(f,Be),ye.delete(f)):ye.set(f,u)}hs.delete(o),d!==s&&d.parentNode?.removeChild(d)}});return En.set(l,c),l}let En=new WeakMap;function cs(t,e,s=!1){var i=t,n=null,r=null,a=T,h=s?Rt:0,o=!1;const l=(u,v=!0)=>{o=!0,f(v,u)};var c=null;function d(){c!==null&&(c.lastChild.remove(),i.before(c),c=null);var u=a?n:r,v=a?r:n;u&&Kt(u),v&&Wt(v,()=>{a?r=null:n=null})}const f=(u,v)=>{if(a!==(a=u)){var m=Cs(),y=i;if(m&&(c=document.createDocumentFragment(),c.append(y=gt())),a?n??=v&&Ue(()=>v(y)):r??=v&&Ue(()=>v(y)),m){var L=F,_=a?n:r,p=a?r:n;_&&L.skipped_effects.delete(_),p&&L.skipped_effects.add(p),L.add_callback(d)}else d()}};As(()=>{o=!1,e(l),o||f(null,null)},h)}function bn(t,e){return e}function Mn(t,e,s){for(var i=t.items,n=[],r=e.length,a=0;a<r;a++)$t(e[a].e,n,!0);var h=r>0&&n.length===0&&s!==null;if(h){var o=s.parentNode;Qi(o),o.append(s),i.clear(),Y(t,e[0].prev,e[r-1].next)}Rs(n,()=>{for(var l=0;l<r;l++){var c=e[l];h||(i.delete(c.k),Y(t,c.prev,c.next)),Q(c.e,!h)}})}function kn(t,e,s,i,n,r=null){var a=t,h={flags:e,items:new Map,first:null},o=null,l=!1,c=new Map,d=qt(()=>{var m=s();return Dt(m)?m:m==null?[]:At(m)}),f,u;function v(){Hn(u,f,h,c,a,n,e,i,s),r!==null&&(f.length===0?o?Kt(o):o=Ue(()=>r(a)):o!==null&&Wt(o,()=>{o=null}))}As(()=>{u??=x,f=g(d);var m=f.length;if(!(l&&m===0)){l=m===0;var y,L,_,p;if(Cs()){var M=new Set,R=F;for(L=0;L<m;L+=1){_=f[L],p=i(_,L);var w=h.items.get(p)??c.get(p);w?Xs(w,_,L):(y=qs(null,h,null,null,_,p,L,n,e,s,!0),c.set(p,y)),M.add(p)}for(const[we,K]of h.items)M.has(we)||R.skipped_effects.add(K.e);R.add_callback(v)}else v();g(d)}})}function Hn(t,e,s,i,n,r,a,h,o){var l=e.length,c=s.items,d=s.first,f=d,u,v=null,m=[],y=[],L,_,p,M;for(M=0;M<l;M+=1){if(L=e[M],_=h(L,M),p=c.get(_),p===void 0){var R=i.get(_);if(R!==void 0){i.delete(_),c.set(_,R);var w=v?v.next:f;Y(s,v,R),Y(s,R,w),wt(R,w,n),v=R}else{var we=f?f.e.nodes_start:n;v=qs(we,s,v,v===null?s.first:v.next,L,_,M,r,a,o)}c.set(_,v),m=[],y=[],f=v.next;continue}if(Xs(p,L,M),(p.e.f&q)!==0&&Kt(p.e),p!==f){if(u!==void 0&&u.has(p)){if(m.length<y.length){var K=y[0],X;v=K.prev;var Te=m[0],De=m[m.length-1];for(X=0;X<m.length;X+=1)wt(m[X],K,n);for(X=0;X<y.length;X+=1)u.delete(y[X]);Y(s,Te.prev,De.next),Y(s,v,Te),Y(s,De,K),f=K,v=De,M-=1,m=[],y=[]}else u.delete(p),wt(p,f,n),Y(s,p.prev,p.next),Y(s,p,v===null?s.first:v.next),Y(s,v,p),v=p;continue}for(m=[],y=[];f!==null&&f.k!==_;)(f.e.f&q)===0&&(u??=new Set).add(f),y.push(f),f=f.next;if(f===null)continue;p=f}m.push(p),v=p,f=p.next}if(f!==null||u!==void 0){for(var Ae=u===void 0?[]:At(u);f!==null;)(f.e.f&q)===0&&Ae.push(f),f=f.next;var Oe=Ae.length;if(Oe>0){var se=null;Mn(s,Ae,se)}}t.first=s.first&&s.first.e,t.last=v&&v.e;for(var Pe of i.values())Q(Pe.e);i.clear()}function Xs(t,e,s,i){at(t.v,e),t.i=s}function qs(t,e,s,i,n,r,a,h,o,l,c){var d=(o&Ti)!==0,f=(o&Ai)===0,u=d?f?re(n,!1,!1):Ie(n):n,v=(o&Di)===0?a:Ie(a),m={i:v,v:u,k:r,a:null,e:null,prev:s,next:i};try{if(t===null){var y=document.createDocumentFragment();y.append(t=gt())}return m.e=Ue(()=>h(t,u,v,l),Ii),m.e.prev=s&&s.e,m.e.next=i&&i.e,s===null?c||(e.first=m):(s.next=m,s.e.next=m.e),i!==null&&(i.prev=m,i.e.prev=m.e),m}finally{}}function wt(t,e,s){for(var i=t.next?t.next.e.nodes_start:s,n=e?e.e.nodes_start:s,r=t.e.nodes_start;r!==null&&r!==i;){var a=mt(r);n.before(r),r=a}}function Y(t,e,s){e===null?t.first=s:(e.next=s,e.e.next=s&&s.e),s!==null&&(s.prev=e,s.e.prev=e&&e.e)}function Ys(t){var e,s,i="";if(typeof t=="string"||typeof t=="number")i+=t;else if(typeof t=="object")if(Array.isArray(t)){var n=t.length;for(e=0;e<n;e++)t[e]&&(s=Ys(t[e]))&&(i&&(i+=" "),i+=s)}else for(s in t)t[s]&&(i&&(i+=" "),i+=s);return i}function Cn(){for(var t,e,s=0,i="",n=arguments.length;s<n;s++)(t=arguments[s])&&(e=Ys(t))&&(i&&(i+=" "),i+=e);return i}function Tn(t){return typeof t=="object"?Cn(t):t??""}function Dn(t,e,s){var i=t==null?"":""+t;return i=i?i+" "+e:e,i===""?null:i}function An(t,e){return t==null?null:String(t)}function On(t,e,s,i,n,r){var a=t.__className;if(a!==s||a===void 0){var h=Dn(s,i);h==null?t.removeAttribute("class"):t.setAttribute("class",h),t.__className=s}return r}function Pn(t,e,s,i){var n=t.__style;if(n!==e){var r=An(e);r==null?t.removeAttribute("style"):t.style.cssText=r,t.__style=e}return i}const Nn=Symbol("is custom element"),Rn=Symbol("is html");function D(t,e,s,i){var n=Bn(t);n[e]!==(n[e]=s)&&(e==="loading"&&(t[pi]=s),s==null?t.removeAttribute(e):typeof s!="string"&&Fn(t).includes(e)?t[e]=s:t.setAttribute(e,s))}function Bn(t){return t.__attributes??={[Nn]:t.nodeName.includes("-"),[Rn]:t.namespaceURI===Fi}}var fs=new Map;function Fn(t){var e=fs.get(t.nodeName);if(e)return e;fs.set(t.nodeName,e=[]);for(var s,i=t,n=Element.prototype;n!==i;){s=ms(i);for(var r in s)s[r].set&&e.push(r);i=Ot(i)}return e}function us(t,e){return t===e||t?.[ve]===e}function In(t={},e,s,i){return rn(()=>{var n,r;return Gt(()=>{n=r,r=[],k(()=>{t!==s(...r)&&(e(t,...r),n&&us(s(...n),t)&&e(null,...n))})}),()=>{ys(()=>{r&&us(s(...r),t)&&e(null,...r)})}}),t}function Gs(t=!1){const e=E,s=e.l.u;if(!s)return;let i=()=>O(e.s);if(t){let n=0,r={};const a=Xt(()=>{let h=!1;const o=e.s;for(const l in o)o[l]!==r[l]&&(r[l]=o[l],h=!0);return h&&n++,n});i=()=>g(a)}s.b.length&&sn(()=>{ds(e,i),Et(s.b)}),kt(()=>{const n=k(()=>s.m.map(vi));return()=>{for(const r of n)typeof r=="function"&&r()}}),s.a.length&&kt(()=>{ds(e,i),Et(s.a)})}function ds(t,e){if(t.l.s)for(const s of t.l.s)g(s);e()}let Ze=!1;function Un(t){var e=Ze;try{return Ze=!1,[t(),Ze]}finally{Ze=e}}function b(t,e,s,i){var n=!Ce||(s&Oi)!==0,r=(s&Ni)!==0,a=i,h=!0,o=()=>(h&&(h=!1,a=i),a),l;{var c=ve in t||_i in t;l=Ee(t,e)?.set??(c&&e in t?_=>t[e]=_:void 0)}var d,f=!1;[d,f]=Un(()=>t[e]),d===void 0&&i!==void 0&&(d=o(),l&&(n&&Mi(),l(d)));var u;if(n?u=()=>{var _=t[e];return _===void 0?o():(h=!0,_)}:u=()=>{var _=t[e];return _!==void 0&&(a=void 0),_===void 0?a:_},n&&(s&Pi)===0)return u;if(l){var v=t.$$legacy;return function(_,p){return arguments.length>0?((!n||!p||v||f)&&l(p?u():_),_):u()}}var m=!1,y=qt(()=>(m=!1,u()));g(y);var L=x;return function(_,p){if(arguments.length>0){const M=p?g(y):n&&r?Se(_):_;return A(y,M),m=!0,a!==void 0&&(a=M),_}return pe&&m||(L.f&_e)!==0?y.v:g(y)}}function Vn(t){E===null&&xi(),Ce&&E.l!==null?zn(E).m.push(t):kt(()=>{const e=k(t);if(typeof e=="function")return e})}function zn(t){var e=t.l;return e.u??={a:[],b:[],m:[]}}const jn="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(jn);zi();const Zt="gySVGObject",Xn="http://www.w3.org/2000/svg",We="object",Ws="function",$s="string",qn="undefined",Ks="",xt=new WeakMap,yt=new Set;class Js{constructor(e){this._el=e,this._animates=[],this._timeouts=[]}get[Symbol.toStringTag](){return Zt}get el(){return this._el}add(e){let s=Z(e,$s)?Zs(e):ct(e)?e:ze(e);return this._el.appendChild(s._el),s}attachTo(e){return(Z(e,We)?ct(e)?e._el:e:document.querySelector(e)).appendChild(this._el),this}id(e){return e?(this._el.setAttribute("id",e),this):this._el.id||(this._el.id=Yn())}ref(){return`#${this.id()}`}url(){return`url(#${this.id()})`}animateTo(e,s=200,i,n){const r=this._animates,a=this._timeouts,h=()=>{a.forEach(c=>clearTimeout(c)),a.length=0,r.forEach(c=>c.remove()),r.length=0},o=(c=!0)=>{h();for(let d of Object.keys(e))this[d](e[d]);typeof n=="function"&&n(this)};if(s===0)return o(!1),this;h();let l=!1;for(let c of Object.keys(e))if(this[c]()!==e[c]){l=!0;const d=this.add("animate").attributeName(c).to(e[c]).fill("freeze").dur(s+"ms");d.beginElement(),r.push(d)}return l&&(typeof i=="function"&&i(this),a.push(setTimeout(o,s+10))),this}}const Z=(t,e)=>typeof t===e,tt=(t,e)=>t instanceof e,Yn=()=>Zt+Math.random().toString(32).substring(2),ct=t=>typeof t===We&&t[Symbol.toStringTag]===Zt,Zs=t=>ze(document.createElementNS(Xn,t)),Gn=t=>({content:"innerHTML",source:"outerHTML",parent:"parentElement",next:"nextElementSibling",previous:"previousElementSibling"})[t]||t,ze=t=>{if(!Z(t,We)||t===null)return null;if(xt.has(t))return xt.get(t);const e=new Proxy(new Js(t),{get(s,i){if(["el",Symbol.toStringTag].includes(i)||i[0]==="_")return s[i];if(!Z(s[i],qn))return(...n)=>fe(e,i,n)||s[i].call(e,...n);if(i==="d"&&t.tagName.toLowerCase()==="path"){let n=Ks;const r=new Proxy(a=>fe(e,i,[a])||a?t.setAttribute("d",a)||e:t.getAttribute("d"),{get(a,h){return(...o)=>(n+=`${h}${fe(e,i,o)||o.join(",")}`,t.setAttribute(i,n),r)}});return r}return i=Gn(i),Z(t[i],Ws)?(...n)=>{const r=fe(e,i,n)||t[i].call(t,...n);return r===void 0?e:ei(r)}:Qs(t,i,e)}});return xt.set(t,e),e},Qs=(t,e,s,i)=>{if(typeof e=="symbol")return t[e];const n=e.replace(/_/g,"-"),r=(...a)=>{const h=fe(s,i?`${i}.${e}`:e,a);if(h!==void 0)return h;if(a.length===0){const l=n in t&&(!t.hasAttribute||!t.hasAttribute(n))?t[n]:t.getAttribute(n);return ei(l)}const o=a[0];if(tt(t,CSSStyleDeclaration))return t[n]=o,s;if(n in t&&!yt.has(n)){if(t[n]===o)return s;const l=t[n];try{t[n]=o}catch{yt.add(n)}if(Z(t[n],We)&&t[n]===o||t[n]!==l)return s;yt.add(n)}return o!==0&&!o?t.removeAttribute(n):t.setAttribute(n,String(a)),s};return new Proxy(r,{get(a,h){const o=t[n][h];return Z(o,Ws)?(...l)=>{const c=fe(s,`${e}.${h}`,l)||o.call(t[n],...l);return c===void 0?s:c}:Qs(t[n],h,s,n)},set(a,h,o){return t[n][h]=o}})},ei=t=>tt(t,HTMLCollection)||tt(t,NodeList)?[...t].map(e=>ze(e)):tt(t,SVGElement)?ze(t):Z(t,$s)?Number.isNaN(Number(t))?t:Number(t):t,fe=(t,e,s)=>{if(t._call)return t._call(t,e,s)};function je(t){return fe(je,Ks,[t]),Z(t,We)?ct(t)?t:ze(t):Zs(t||"svg")}je.isWrapped=ct;je.extend=t=>t(je,Js);class Wn{stack=[];current=-1;listeners=[];addListener(e){this.listeners.push(e)}execute(e){this.current+1<this.stack.length&&this.stack.splice(this.current+1,this.stack.length-this.current),this.stack.push(e),this.current+=1,e.execute(),this.fireChange()}canUndo(){return this.current>=0}canRedo(){return this.current+1<this.stack.length}undo(){this.canUndo()&&(this.stack[this.current].undo(),this.current-=1,this.fireChange())}redo(){this.canRedo()&&(this.current+=1,this.stack[this.current].redo(),this.fireChange())}fireChange(){this.listeners.forEach(e=>{e({canUndo:this.canUndo(),canRedo:this.canRedo()})})}}class N{constructor(e,s){this.x=e,this.y=s}centeredRect(e,s){return new Xe(this.x-e/2,this.y-s/2,e,s)}rect(e,s){return new Xe(this.x,this.y,e,s)}distance(e){const s=this.x-e.x,i=this.y-e.y;return Math.sqrt(s*s+i*i)}move(e,s){return new N(this.x+e,this.y+s)}}class Xe{constructor(e,s,i,n){this.x=e,this.y=s,this.width=i,this.height=n}contains(e){return this.x<=e.x&&e.x<this.corner().x&&this.y<=e.y&&e.y<this.corner().y}corner(){return new N(this.x+this.width,this.y+this.height)}expand(e){return new Xe(this.x-e,this.y-e,this.width+e*2,this.height+e*2)}center(){return new N(this.x+this.width/2,this.y+this.height/2)}topCenter(){return new N(this.x+this.width/2,this.y)}topRight(){return new N(this.x+this.width,this.y)}}function $n(){const t={},e=new Promise((s,i)=>{t.resolve=s,t.reject=i});return t.promise=e,t}function St(t,e){const s={};return t.forEach(i=>{s[e(i)]=i}),s}class Kn{mainEl;inputEl;editDefer=null;constructor(e){this.mainEl=document.createElement("div"),this.mainEl.classList.add("directEdit"),e.appendChild(this.mainEl),this.inputEl=document.createElement("input"),this.mainEl.appendChild(this.inputEl),this.mainEl.addEventListener("mouseup",s=>{this.editDefer&&s.target!==this.inputEl&&(this.editDefer.reject(),this.close())}),this.inputEl.addEventListener("keyup",s=>{this.editDefer&&(s.keyCode==27?(this.editDefer.reject(),this.close()):s.keyCode==13&&(this.editDefer.resolve(this.inputEl.value),this.close()))})}close(){this.mainEl.classList.remove("opened")}start(e){return this.editDefer=$n(),e?(this.mainEl.classList.add("opened"),this.inputEl.value=e.value,this.inputEl.style.left=`${e.bounds.x}px`,this.inputEl.style.top=`${e.bounds.y}px`,this.inputEl.style.width=`${e.bounds.width}px`,this.inputEl.style.height=`${e.bounds.height}px`,this.inputEl.select(),this.inputEl.focus()):(console.log("START DIRECT EDIT WITH NULL"),this.close(),this.editDefer.reject()),this.editDefer.promise}}class Jn{context;constructor(){const e=document.createElement("canvas");this.context=e.getContext("2d")}measure(e,s){return this.context.font=s+" arial",this.context.measureText(e)}}class Zn{measurer=new Jn;commandStack=new Wn;directEdit;rootView;state;model;container;svg;constructor(e,s){this.directEdit=new Kn(s.container),this.container=this.createContainer(s.container),window.addEventListener("resize",a=>this.resizePage()),this.svg=this.createSvg(this.container,e);const{model:i,view:n,state:r}=e.initialize(this);this.model=i,this.rootView=n,this.state=r,this.resizePage()}mouseDown(e){const s=new N(e.clientX,e.clientY);this.state=this.state.mouseDown(s)}mouseUp(e){const s=new N(e.clientX,e.clientY);this.state=this.state.mouseUp(s)}mouseMove(e){const s=new N(e.clientX,e.clientY);this.state=this.state.mouseMove(s)}undo(){this.commandStack.undo(),this.rootView.render()}redo(){this.commandStack.redo(),this.rootView.render()}executeCommand(e){this.commandStack.execute(e),this.rootView.render()}onStackChange(e){this.commandStack.addListener(e)}createContainer(e){const s=document.createElement("div");return s.setAttribute("class","editor-container"),e.appendChild(s),s.addEventListener("mousedown",i=>this.mouseDown(i)),s.addEventListener("mouseup",i=>this.mouseUp(i)),s.addEventListener("mousemove",i=>this.mouseMove(i)),s}createSvg(e,s){const i=je().viewBox(0,0,100,100);return i.attachTo(e),s.initializeSvg(i),i}resizePage(){const e=this.container.clientWidth,s=this.container.clientHeight;this.svg.viewBox(0,0,e,s).width(e).height(s)}}const Qe=parseFloat;function ft(t,e=";"){let s;if(Array.isArray(t))s=t.filter(i=>i);else{s=[];for(const i in t)t[i]&&s.push(`${i}:${t[i]}`)}return s.join(e)}function Qn(t,e,s,i){let n,r;const a="1em";let h,o,l,c="-.125em";const d="visible";return i&&(l="center",r="1.25em"),s&&(n=s),e&&(e=="lg"?(o="1.33333em",h=".75em",c="-.225em"):e=="xs"?o=".75em":e=="sm"?o=".875em":o=e.replace("x","em")),ft([ft({float:n,width:r,height:a,"line-height":h,"font-size":o,"text-align":l,"vertical-align":c,"transform-origin":"center",overflow:d}),t])}function er(t,e,s,i,n,r=1,a="",h=""){let o=1,l=1;return n&&(n=="horizontal"?o=-1:n=="vertical"?l=-1:o=l=-1),ft([`translate(${Qe(e)*r}${a},${Qe(s)*r}${a})`,`scale(${o*Qe(t)},${l*Qe(t)})`,i&&`rotate(${i}${h})`]," ")}var tr=Jt('<path class="svelte-1cj2gr0"></path>'),sr=Jt('<path class="svelte-1cj2gr0"></path><path class="svelte-1cj2gr0"></path>',1),ir=Jt('<svg aria-hidden="true" role="img" xmlns="http://www.w3.org/2000/svg"><g class="svelte-1cj2gr0"><g class="svelte-1cj2gr0"><!></g></g></svg>');function vs(t,e){Vt(e,!1);let s=b(e,"class",8,""),i=b(e,"id",8,""),n=b(e,"style",8,""),r=b(e,"icon",8),a=b(e,"size",8,""),h=b(e,"color",8,""),o=b(e,"fw",8,!1),l=b(e,"pull",8,""),c=b(e,"scale",8,1),d=b(e,"translateX",8,0),f=b(e,"translateY",8,0),u=b(e,"rotate",8,""),v=b(e,"flip",8,!1),m=b(e,"spin",8,!1),y=b(e,"pulse",8,!1),L=b(e,"primaryColor",8,""),_=b(e,"secondaryColor",8,""),p=b(e,"primaryOpacity",8,1),M=b(e,"secondaryOpacity",8,.4),R=b(e,"swapOpacity",8,!1),w=re(),we=re(),K=re(),X=re();Je(()=>O(r()),()=>{A(w,r()&&r().icon||[0,0,"",[],""])}),Je(()=>(O(s()),O(m()),O(y())),()=>{A(we,ft([s(),"svelte-fa",m()&&"spin",y()&&"pulse"]," "))}),Je(()=>(O(n()),O(a()),O(l()),O(o())),()=>{A(K,Qn(n(),a(),l(),o()))}),Je(()=>(O(c()),O(d()),O(f()),O(u()),O(v())),()=>{A(X,er(c(),d(),f(),u(),v(),512))}),an(),Gs();var Te=xn(),De=rs(Te);{var Ae=Oe=>{var se=ir(),Pe=z(se),Qt=z(Pe),li=z(Qt);{var hi=xe=>{var ce=tr();Fe(()=>{D(ce,"d",(g(w),k(()=>g(w)[4]))),D(ce,"fill",h()||L()||"currentColor"),D(ce,"transform",(g(w),k(()=>`translate(${g(w)[0]/-2} ${g(w)[1]/-2})`)))}),Le(xe,ce)},ci=xe=>{var ce=sr(),Ne=rs(ce),$e=et(Ne);Fe(()=>{D(Ne,"d",(g(w),k(()=>g(w)[4][0]))),D(Ne,"fill",_()||h()||"currentColor"),D(Ne,"fill-opacity",R()!=!1?p():M()),D(Ne,"transform",(g(w),k(()=>`translate(${g(w)[0]/-2} ${g(w)[1]/-2})`))),D($e,"d",(g(w),k(()=>g(w)[4][1]))),D($e,"fill",L()||h()||"currentColor"),D($e,"fill-opacity",R()!=!1?M():p()),D($e,"transform",(g(w),k(()=>`translate(${g(w)[0]/-2} ${g(w)[1]/-2})`)))}),Le(xe,ce)};cs(li,xe=>{g(w),k(()=>typeof g(w)[4]=="string")?xe(hi):xe(ci,!1)})}Fe(()=>{D(se,"id",i()),On(se,0,Tn(g(we)),"svelte-1cj2gr0"),Pn(se,g(K)),D(se,"viewBox",(g(w),k(()=>`0 0 ${g(w)[0]} ${g(w)[1]}`))),D(Pe,"transform",(g(w),k(()=>`translate(${g(w)[0]/2} ${g(w)[1]/2})`))),D(Pe,"transform-origin",(g(w),k(()=>`${g(w)[0]/4} 0`))),D(Qt,"transform",g(X))}),Le(Oe,se)};cs(De,Oe=>{g(w),k(()=>g(w)[4])&&Oe(Ae)})}Le(t,Te),zt()}/*!
 * Font Awesome Free 5.15.3 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 */var ti={icon:[576,512,[],"f044","M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"]},nr={prefix:"fas",iconName:"redo",icon:[512,512,[],"f01e","M500.33 0h-47.41a12 12 0 0 0-12 12.57l4 82.76A247.42 247.42 0 0 0 256 8C119.34 8 7.9 119.53 8 256.19 8.1 393.07 119.1 504 256 504a247.1 247.1 0 0 0 166.18-63.91 12 12 0 0 0 .48-17.43l-34-34a12 12 0 0 0-16.38-.55A176 176 0 1 1 402.1 157.8l-101.53-4.87a12 12 0 0 0-12.57 12v47.41a12 12 0 0 0 12 12h200.33a12 12 0 0 0 12-12V12a12 12 0 0 0-12-12z"]},si={icon:[448,512,[],"f2ed","M32 464a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128H32zm272-256a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zM432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z"]},rr={prefix:"fas",iconName:"undo",icon:[512,512,[],"f0e2","M212.333 224.333H12c-6.627 0-12-5.373-12-12V12C0 5.373 5.373 0 12 0h48c6.627 0 12 5.373 12 12v78.112C117.773 39.279 184.26 7.47 258.175 8.007c136.906.994 246.448 111.623 246.157 248.532C504.041 393.258 393.12 504 256.333 504c-64.089 0-122.496-24.313-166.51-64.215-5.099-4.622-5.334-12.554-.467-17.42l33.967-33.967c4.474-4.474 11.662-4.717 16.401-.525C170.76 415.336 211.58 432 256.333 432c97.268 0 176-78.716 176-176 0-97.267-78.716-176-176-176-58.496 0-110.28 28.476-142.274 72.333h98.274c6.627 0 12 5.373 12 12v48c0 6.627-5.373 12-12 12z"]},ar=js('<li class="spacer svelte-1jbr9wa"><button> </button></li>'),or=js('<div class="container svelte-1jbr9wa"><div></div> <div class="palette svelte-1jbr9wa"><ul class="svelte-1jbr9wa"><li class="svelte-1jbr9wa"><button title="Undo"><!></button></li> <li class="svelte-1jbr9wa"><button title="Redo"><!></button></li> <!></ul></div></div>');function lr(t,e){Vt(e,!1);let s=b(e,"diagramType",8),i=re(),n=re(),r=re({canUndo:!1,canRedo:!1});Vn(()=>{A(n,new Zn(s(),{container:g(i)})),g(n).onStackChange(L=>{A(r,L)})}),Gs();var a=or(),h=z(a);In(h,L=>A(i,L),()=>g(i));var o=et(h,2),l=z(o),c=z(l),d=z(c),f=z(d);vs(f,{get icon(){return rr}});var u=et(c,2),v=z(u),m=z(v);vs(m,{get icon(){return nr}});var y=et(u,2);kn(y,1,()=>(O(s()),k(()=>s().actions)),bn,(L,_)=>{var p=ar(),M=z(p),R=z(M);Fe(()=>yn(R,(g(_),k(()=>g(_).label)))),pt("click",M,()=>g(_).run(g(n))),Le(L,p)}),Fe(()=>{d.disabled=(g(r),k(()=>!g(r).canUndo)),v.disabled=(g(r),k(()=>!g(r).canRedo))}),pt("click",d,()=>g(n).undo()),pt("click",v,()=>g(n).redo()),Le(t,a),zt()}class hr{constructor(e,s){this.message=e,this.end=s,this.oldEnd=this.message.from}oldEnd;execute(){this.message.from=this.end}undo(){this.message.from=this.oldEnd}redo(){this.execute()}}class cr{constructor(e,s){this.message=e,this.end=s,this.oldEnd=this.message.to}oldEnd;execute(){this.message.to=this.end}undo(){this.message.to=this.oldEnd}redo(){this.execute()}}class fr{constructor(e,s){this.model=e,this.lifeLine=s}execute(){this.model.lifeLines.push(this.lifeLine)}undo(){this.model.lifeLines.pop()}redo(){this.execute()}}class ur{constructor(e,s,i=-1){this.model=e,this.message=s,this.position=i,i<0&&(this.position=e.messages.length)}execute(){this.model.messages.splice(this.position,0,this.message)}undo(){this.model.messages.splice(this.position,1)}redo(){this.execute()}}class dr{constructor(e,s,i){this.model=e,this.message=s,this.position=i,this.oldPosition=this.model.messages.indexOf(s)}oldPosition;execute(){this.model.messages.splice(this.oldPosition,1),this.model.messages.splice(this.position,0,this.message)}undo(){this.model.messages.splice(this.position,1),this.model.messages.splice(this.oldPosition,0,this.message)}redo(){this.execute()}}class vr{constructor(e,s){this.message=e,this.newText=s,this.oldText=this.message.text}oldText;execute(){this.message.text=this.newText}undo(){this.message.text=this.oldText}redo(){this.execute()}}class gr{constructor(e,s){this.model=e,this.message=s,this.oldPosition=this.model.messages.indexOf(s)}oldPosition;execute(){this.model.messages.splice(this.model.messages.indexOf(this.message),1)}undo(){this.model.messages.splice(this.oldPosition,0,this.message)}redo(){this.execute()}}class mr{constructor(e,s){this.lifeLine=e,this.newName=s,this.oldName=this.lifeLine.name}oldName;execute(){this.lifeLine.name=this.newName}undo(){this.lifeLine.name=this.oldName}redo(){this.execute()}}class _r{constructor(e,s,i){this.model=e,this.lifeLine=s,this.position=i,this.oldPosition=this.model.lifeLines.indexOf(s)}oldPosition;execute(){this.model.lifeLines.splice(this.oldPosition,1),this.model.lifeLines.splice(this.position,0,this.lifeLine)}undo(){this.model.lifeLines.splice(this.position,1),this.model.lifeLines.splice(this.oldPosition,0,this.lifeLine)}redo(){this.execute()}}class pr{constructor(e,s){this.model=e,this.lifeLine=s,this.removedMessages=e.messages.map((i,n)=>({message:i,position:n})).filter(i=>i.message.from===s||i.message.to===s),this.oldPosition=this.model.lifeLines.indexOf(s)}oldPosition;removedMessages;execute(){this.removedMessages.reverse().forEach(e=>{this.model.messages.splice(e.position,1)}),this.model.lifeLines.splice(this.model.lifeLines.indexOf(this.lifeLine),1)}undo(){this.model.lifeLines.splice(this.oldPosition,0,this.lifeLine),this.removedMessages.forEach(e=>{this.model.messages.splice(e.position,0,e.message)})}redo(){this.execute()}}let ii=0;function wr(){const t=[Ct("Roméo"),Ct("Juliette")];return{lifeLines:t,messages:[Tt(t[0],t[1],"Je t'aime"),Tt(t[1],t[0],"Moi non plus")]}}function Ct(t="actor"){return{id:`L${ii++}`,name:t}}function Tt(t,e,s="message"){return{id:`M${ii++}`,from:t,to:e,text:s}}class xr{icon=ti.icon[4];action(e,s){const{diagram:i,message:n}=s,r={value:n.model.text,bounds:n.textBounds.expand(3)};i.directEdit(r).then(a=>{e.execute(new vr(n.model,a)),i.layout()},()=>{})}}class yr{icon=si.icon[4];action(e,s){const{diagram:i,message:n}=s;e.execute(new gr(i.model,n.model)),i.unselectAll(),i.render()}}class Sr{icon=ti.icon[4];action(e,s){const{diagram:i,lifeLine:n}=s,r={value:n.model.name,bounds:n.textBounds.expand(3)};i.directEdit(r).then(a=>{e.execute(new mr(n.model,a)),i.layout()},()=>{})}}class Lr{icon=si.icon[4];action(e,s){const{diagram:i,lifeLine:n}=s;e.execute(new pr(i.model,n.model)),i.unselectAll(),i.render()}}class Er{constructor(e,s,i,n,r){this.bounds=e,this.tool=s,this.context=i,this.parentSvg=n,this.commandStack=r,this.draw()}hover=!1;svg;testHover(e){this.bounds.contains(e)?this.setHover(!0):this.setHover(!1)}setHover(e){this.hover!=e&&(this.hover=e,ue(this.svg,this.hover,"hover"))}draw(){this.svg=this.parentSvg.add("g").transform(`translate(${this.bounds.x},${this.bounds.y})`),this.svg.el.classList.add("tool"),this.svg.add("rect").rx(5).ry(5).width(this.bounds.width).height(this.bounds.height).fill("white"),this.svg.add("g").transform("translate(4,3) scale(0.039)").add("path").d(this.tool.icon)}action(){this.tool.action(this.commandStack,this.context)}remove(){this.svg.remove()}}class br{constructor(e,s,i,n,r,a){this.model=e,this.style=s,this.measurer=i,this.svg=n,this.directEdit=r,this.commandStack=a,this.shapesSvg=this.svg.add("g"),this.feedbackSvg=this.svg.add("g"),this.toolsSvg=this.svg.add("g"),this.render()}messageStart=0;pendingDragMessage=null;pendingMessage=null;pendingLifeLine=null;startMessageHandle=null;tools=[];shapesSvg;feedbackSvg;toolsSvg;lifeLines=[];messages=[];render(){this.lifeLines.forEach(n=>n.clearFlags());const e=St(this.lifeLines,n=>n.model.id);this.lifeLines=this.model.lifeLines.map((n,r)=>{const a=e[n.id],h=a!=null?a.updateIndex(r):this.createLifeline(n,r);return h.setUsed(),h});for(let n in e){const r=e[n];r.isUsed()||r.remove()}const s=St(this.lifeLines,n=>n.model.id);this.messages.forEach(n=>n.clearFlags());const i=St(this.messages,n=>n.model.id);this.messages=this.model.messages.map(n=>{const r=i[n.id],a=r??this.createMessage(n,s);return a.setUsed(),a});for(let n in i){const r=i[n];r.isUsed()||r.remove()}this.layout()}createLifeline(e,s){return new Dr(e,s,this.style,this.measurer,this.shapesSvg)}createMessage(e,s){return new Ar(e,s[e.from.id],s[e.to.id],!1,this.style,this.measurer,this.shapesSvg)}testHover(e){let s=!1;if(this.tools.forEach(n=>{n.testHover(e),s||=n.hover}),s){this.clearOtherHover();return}this.lifeLines.forEach(n=>{n.testHover(e)});let i=!1;this.messages.forEach(n=>{n.testHover(e),i||=n.hover}),i?this.clearStartMessageHandle():this.testHoverInsertMessage(e)}testHoverInsertMessage(e){let s=!1;this.lifeLines.forEach(i=>{if(i.isNearLine(e)){const n=new N(i.centerX(),e.y);this.startMessageHandle?this.startMessageHandle.update(n):this.startMessageHandle=new Mr(i,n,this.feedbackSvg),s=!0}}),s||this.clearStartMessageHandle()}clearStartMessageHandle(){this.startMessageHandle&&(this.startMessageHandle.remove(),this.startMessageHandle=null)}clearOtherHover(){this.messages.forEach(e=>e.setHover(!1)),this.lifeLines.forEach(e=>e.setHover(!1))}startDragMessageHandle(e,s){this.pendingMessage=new kr(e,s,this.feedbackSvg)}startDragNewMessageHandle(e){this.pendingMessage=new Hr(this,this.startMessageHandle.lifeLine,this.startMessageHandle.position.y,e,this.feedbackSvg),this.clearStartMessageHandle()}updateDragMessageHandle(e){let s=null;this.lifeLines.forEach(i=>{Math.abs(i.centerX()-e)<10&&(s=i)}),this.pendingMessage.setHover(s,e)}finishDragMessageHandle(){this.pendingMessage.finish(this.commandStack),this.pendingMessage=null,this.render()}startDragMessage(e,s){this.unselectAll(),this.pendingDragMessage=new Cr(this,e,s)}updateDragMessage(e){this.pendingDragMessage.setPosition(e)}finishDragMessage(){this.pendingDragMessage.finish(this.commandStack),this.pendingDragMessage=null,this.layout()}startDragLifeLine(e,s){this.pendingLifeLine=new Tr(this,e,s,this.feedbackSvg)}updateDragLifeLine(e){this.pendingLifeLine.updatePosition(e)}finishDragLifeLine(){this.pendingLifeLine.finish(this.commandStack),this.pendingLifeLine=null}findMessageHandle(e){for(let s of this.messages){if(s.from.bounds().contains(e))return s.from;if(s.to.bounds().contains(e))return s.to}return null}findMessage(e){return this.messages.find(s=>s.markerBounds.contains(e))}findLifeLine(e){return this.lifeLines.find(s=>s.hoverBounds.contains(e))}findTool(e){return this.tools.find(s=>s.bounds.contains(e))}layout(){this.lifeLines.forEach(s=>s.measureText()),this.messages.forEach(s=>s.measureText()),this.messageStart=0,this.lifeLines.forEach(s=>{this.messageStart=Math.max(this.messageStart,s.headHeight)});let e=this.messageStart+this.style.messageStartGap;this.messages.forEach(s=>{s.y=e,e+=this.style.messageGap}),this.lifeLines.forEach(s=>{s.x=this.style.leftMargin,s.y=this.style.topMargin,s.lineHeight=e-this.messageStart}),this.lifeLines.forEach(s=>{if(this.messages.forEach(i=>{const n=i.width+this.style.messageMargin*2;if(i.from.lifeLine==s&&i.to.lifeLine.index<s.index){const r=s.centerX()-i.to.lifeLine.centerX();r<n&&(s.x+=n-r)}else if(i.to.lifeLine==s&&i.from.lifeLine.index<s.index){const r=s.centerX()-i.from.lifeLine.centerX();r<n&&(s.x+=n-r)}}),s.index>0){const i=this.lifeLines[s.index-1],n=i.width+this.style.minHeadGap;s.x-i.x<n&&(s.x=i.x+n)}}),this.lifeLines.forEach(s=>s.layout()),this.messages.forEach(s=>s.layout())}update(){this.lifeLines.forEach(e=>e.update()),this.messages.forEach(e=>e.update())}selectMessage(e){if(this.unselectAll(),e){e.selected=!0;const s={diagram:this,message:e};this.placeTools(e.markerBounds.topCenter().move(0,-30),s,[new xr,new yr])}this.update()}selectLifeLine(e){this.unselectAll();const s=this.resolveLifeline(e);if(s){s.selected=!0;const i={diagram:this,lifeLine:s};this.placeTools(s.hoverBounds.topRight().move(5,5),i,[new Sr,new Lr])}this.update()}resolveLifeline(e){return this.lifeLines.find(s=>s.model==e.model)}unselectAll(){this.messages.forEach(e=>e.selected=!1),this.lifeLines.forEach(e=>e.selected=!1),this.tools.forEach(e=>e.remove()),this.tools=[]}placeTools(e,s,i){let n=e;this.tools=i.map(r=>{const a=new Er(n.rect(26,26),r,s,this.toolsSvg,this.commandStack);return n=n.move(30,0),a})}}class Mr{constructor(e,s,i){this.lifeLine=e,this.position=s,this.svg=i.add("circle").r(6),this.svg.el.classList.add("point-marker","hover"),this.update(s)}svg;update(e){this.position=e,this.svg.cx(e.x).cy(e.y)}remove(){this.svg.remove()}}class ni{constructor(e,s,i,n,r){this.y=e,this.lifeLine=i,this.isMovingFrom=n,n?(this.from=s,this.to=i.centerX()):(this.from=i.centerX(),this.to=s),this.draw(r)}from;to;hoverOther=null;svg;lineSvg;circleSvg;setHover(e,s){e&&e!=this.lifeLine?(this.addHover(e),this.setPosition(this.hoverOther.centerX())):(this.removeHover(),this.setPosition(s))}setPosition(e){this.isMovingFrom?this.from=e:this.to=e,this.update()}addHover(e){this.hoverOther||(this.circleSvg=this.svg.add("circle").r(6),this.circleSvg.el.classList.add("point-marker","hover")),this.hoverOther=e}removeHover(){this.hoverOther&&(this.hoverOther=null,this.circleSvg.remove())}draw(e){this.svg=e.add("g"),this.lineSvg=this.svg.add("line").fill("none").stroke("black").marker_end("url(#triangle)").y1(this.y).y2(this.y),this.update()}update(){this.lineSvg.x1(this.from).x2(this.to),this.hoverOther&&this.circleSvg.cx(this.hoverOther.centerX()).cy(this.y)}finish(e){this.finishAction(e),this.svg.remove()}}class kr extends ni{constructor(e,s,i){super(e.message.y,s,e.message.other(e).lifeLine,e==e.message.from,i),this.handle=e,this.handle.setHover(!1),this.handle.message.setEditing(!0)}finishAction(e){this.handle.message.setEditing(!1),this.hoverOther!=null&&this.hoverOther!=this.lifeLine&&(this.handle.message.from==this.handle?e.execute(new hr(this.handle.message.model,this.hoverOther.model)):e.execute(new cr(this.handle.message.model,this.hoverOther.model)))}}class Hr extends ni{constructor(e,s,i,n,r){super(i,n,s,!1,r),this.diagram=e,this.parentSvg=r}finishAction(e){if(this.hoverOther!=null){let s=0;for(let i of this.diagram.messages){if(this.y<=i.markerBounds.y)break;++s}e.execute(new ur(this.diagram.model,Tt(this.lifeLine.model,this.hoverOther.model),s))}}}class Cr{constructor(e,s,i){this.diagram=e,this.message=s,this.y=i,this.message.y=i,this.oldPosition=e.messages.indexOf(s),this.message.hover=!1}oldPosition;setPosition(e){for(let s of this.diagram.messages)if(s!=this.message&&s.markerBounds.y<=e&&e<=s.markerBounds.corner().y){const n=Math.sign(s.markerBounds.center().y-e)>0?1:0;this.diagram.messages.splice(this.diagram.messages.indexOf(this.message),1),this.diagram.messages.splice(this.diagram.messages.indexOf(s)+n,0,this.message)}this.diagram.layout(),this.message.y=e,this.message.update()}finish(e){const s=this.diagram.messages.indexOf(this.message);s!=this.oldPosition&&e.execute(new dr(this.diagram.model,this.message.model,s))}}class Tr{constructor(e,s,i,n){this.diagram=e,this.lifeLine=s,this.x=i,this.y=this.lifeLine.y,this.width=this.lifeLine.width,this.height=this.lifeLine.headHeight+this.lifeLine.lineHeight,this.draw(n)}x;y;width;height;snap=!1;position=-1;lineSvg;draw(e){this.lineSvg=e.add("line").stroke_dasharray(4),this.update()}update(){this.lineSvg.x1(this.x).y1(this.y).x2(this.x).y2(this.y+this.height).stroke_width(this.snap?3:1).stroke(this.snap?"green":"#55CCFF")}updatePosition(e){this.x=e,this.snap=!1,this.position=-1;let s=null;for(let i of this.diagram.lifeLines){if(s){const n=(s.x+s.width+i.x)/2;if(Math.abs(n-e)<10){this.x=n,this.snap=!0,this.position=this.diagram.lifeLines.indexOf(i);break}}else if(e<i.x){this.x=i.x-10,this.snap=!0,this.position=0;break}s=i}!this.snap&&s&&e>s.x+s.width&&(this.x=s.x+s.width+10,this.snap=!0,this.position=this.diagram.lifeLines.indexOf(s)+1),this.update()}finish(e){this.remove(),this.position>this.lifeLine.index&&(this.position-=1);const s=this.diagram.lifeLines.indexOf(this.lifeLine);this.position>=0&&this.position!=s&&(e.execute(new _r(this.diagram.model,this.lifeLine.model,this.position)),this.diagram.render())}remove(){this.lineSvg.remove()}}const ut=1;class Dr{constructor(e,s,i,n,r){this.model=e,this.index=s,this.style=i,this.text=new ri(this.model.name,this.style.lifeLineHeadTextSize,1,n),this.draw(r)}flags;text;width;headHeight;lineHeight=0;x=0;y=0;selected=!1;hover=!1;hoverBounds;markerBounds;textBounds;textDy;gSvg;rectSvg;textSvg;lineSvg;selectSvg;clearFlags(){this.flags=0}setUsed(){this.flags|=ut}isUsed(){return(this.flags&ut)!=0}updateIndex(e){return this.index=e,this}isNearLine(e){return Math.abs(this.centerX()-e.x)<10&&this.y+this.headHeight<e.y&&e.y<this.y+this.headHeight+this.lineHeight}centerX(){return this.x+this.width/2}testHover(e){this.setHover(this.hoverBounds.contains(e))}setHover(e){this.hover!=e&&(this.hover=e,this.updateHover())}measureText(){this.text.update(this.model.name),this.headHeight=Math.max(this.text.height+this.style.lifeLineHeadMargin*2,this.style.minHeadHeight),this.width=this.text.width+this.style.lifeLineHeadMargin*2,this.textDy=this.style.lifeLineHeadMargin+this.text.ascent+10}layout(){this.textBounds=this.text.boundsAt(new N(this.x+this.width/2,this.y).move(0,this.textDy)),this.hoverBounds=new N(this.x,this.y).rect(this.width,this.headHeight).expand(10),this.markerBounds=new N(this.x,this.y).rect(this.width,this.headHeight+this.lineHeight).expand(10),this.update()}draw(e){this.gSvg=e.add("g"),this.rectSvg=this.gSvg.add("rect").stroke("black").fill("none"),this.textSvg=this.gSvg.add("text").text_anchor("middle"),this.lineSvg=this.gSvg.add("line").stroke_dasharray(4).stroke("black"),this.selectSvg=this.gSvg.add("rect").x(-10).y(-10).rx(10).ry(10).fill("none").stroke_dasharray(4).stroke_width(2),this.selectSvg.el.classList.add("select-marker")}update(){this.gSvg.transform(`translate(${this.x},${this.y})`),this.rectSvg.width(this.width).height(this.headHeight),this.textSvg.dx(this.width/2).dy(this.textDy).style.fontSize(this.text.size).content(this.text.value),this.lineSvg.x1(this.width/2).y1(this.headHeight).x2(this.width/2).y2(this.headHeight+this.lineHeight),this.selectSvg.width(this.markerBounds.width).height(this.markerBounds.height),this.updateHover(),ue(this.selectSvg,this.selected,"selected")}updateHover(){ue(this.selectSvg,!this.selected&&this.hover,"hover")}remove(){this.gSvg.remove()}}function ue(t,e,s){e?t.el.classList.add(s):t.el.classList.remove(s)}class Ar{constructor(e,s,i,n,r,a,h){this.model=e,this.selected=n,this.style=r,this.from=new gs(s,this),this.to=new gs(i,this),this.text=new ri(this.model.text,this.style.messageTextSize,0,a),this.draw(h)}flags=0;from;to;reversed=!1;text;width;height;hover=!1;markerBounds=null;textBounds;y=0;editing=!1;gSvg;lineSvg;textSvg;startCircleSvg;endCircleSvg;selectSvg;clearFlags(){this.flags=0}setUsed(){this.flags|=ut}isUsed(){return(this.flags&ut)!=0}other(e){return e==this.from?this.to:this.from}testHover(e){this.markerBounds.contains(e)?(this.setHover(!0),this.checkOver(this.from.setHover(this.from.bounds().contains(e))),this.checkOver(this.to.setHover(this.to.bounds().contains(e)))):(this.setHover(!1),this.checkOver(this.from.setHover(!1)),this.checkOver(this.to.setHover(!1)))}setHover(e){this.hover!=e&&(this.hover=e,this.updateHover())}checkOver(e){e&&this.updateHover()}measureText(){this.text.update(this.model.text),this.width=this.text.width,this.height=this.text.height}layout(){this.reversed=this.from.lifeLine.index>this.to.lifeLine.index,this.text.align=this.reversed?0:2,this.markerBounds=new Xe(Math.min(this.from.lifeLine.centerX()-10,this.to.lifeLine.centerX()-10),this.y-this.height-7,Math.abs(this.from.lifeLine.centerX()-this.to.lifeLine.centerX())+20,this.height+20);const e=this.reversed?this.style.messageMargin:-this.style.messageMargin;this.textBounds=this.text.boundsAt(new N(this.to.lifeLine.centerX(),this.y).move(e,-7)),this.update()}draw(e){this.gSvg=e.add("g"),this.lineSvg=this.gSvg.add("line").stroke("black").marker_end("url(#triangle)"),this.textSvg=this.gSvg.add("text"),this.startCircleSvg=this.gSvg.add("circle").r(6),this.startCircleSvg.el.classList.add("point-marker"),this.endCircleSvg=this.gSvg.add("circle").r(6),this.endCircleSvg.el.classList.add("point-marker"),this.selectSvg=this.gSvg.add("rect").rx(10).ry(10).fill("none").stroke_dasharray(4).stroke_width(2),this.selectSvg.el.classList.add("select-marker")}update(){this.editing?this.gSvg.el.classList.add("hide"):(this.gSvg.el.classList.remove("hide"),this.lineSvg.x1(this.from.lifeLine.centerX()).y1(this.y).x2(this.to.lifeLine.centerX()).y2(this.y),this.textSvg.y(this.y-7).style.fontSize(this.text.size).content(this.text.value),this.reversed?this.textSvg.x(this.to.lifeLine.centerX()+this.style.messageMargin).text_anchor("start"):this.textSvg.x(this.to.lifeLine.centerX()-this.style.messageMargin).text_anchor("end"),this.startCircleSvg.cx(this.from.center().x).cy(this.from.center().y),this.endCircleSvg.cx(this.to.center().x).cy(this.to.center().y),this.selectSvg.x(this.markerBounds.x).y(this.markerBounds.y).width(this.markerBounds.width).height(this.markerBounds.height),this.updateHover())}updateHover(){ue(this.startCircleSvg,this.from.hover,"hover"),ue(this.endCircleSvg,this.to.hover,"hover"),ue(this.selectSvg,!this.selected&&this.hover,"hover"),ue(this.selectSvg,this.selected,"selected")}remove(){this.gSvg.remove()}setEditing(e){this.editing=e,this.update()}}class ri{constructor(e,s,i,n){this.size=s,this.align=i,this.measurer=n,this.update(e)}value;width;height;ascent;update(e){this.value=e;const s=this.measurer.measure(this.value,this.size);this.width=s.width,this.ascent=s.actualBoundingBoxAscent,this.height=s.actualBoundingBoxAscent+s.actualBoundingBoxDescent}boundsAt(e){return this.align==2?e.move(-this.width,-this.ascent).rect(this.width,this.height):this.align==1?e.move(-this.width/2,-this.ascent).rect(this.width,this.height):e.move(0,-this.ascent).rect(this.width,this.height)}}class gs{constructor(e,s){this.lifeLine=e,this.message=s}hover=!1;center(){return new N(this.lifeLine.centerX(),this.message.y)}bounds(){return this.center().centeredRect(20,20)}setHover(e){return this.hover!=e?(this.hover=e,!0):!1}}class Or{constructor(e){this.view=e}}class ee{constructor(e){this.context=e}mouseDown(e){const s=this.context.view.findTool(e);if(s)return new Pr(this.context,s);const i=this.context.view.findMessageHandle(e);if(i)return new Nr(this.context,e,i);const n=this.context.view.findMessage(e);if(n)return new Rr(this.context,e,n);const r=this.context.view.findLifeLine(e);return r?new Fr(this.context,e,r):this.context.view.startMessageHandle?(this.context.view.startDragNewMessageHandle(e.x),new ai(this.context)):this}mouseUp(e){return this.context.view.unselectAll(),this.context.view.update(),this}mouseMove(e){return this.context.view.testHover(e),this}}class Pr{constructor(e,s){this.context=e,this.tool=s}mouseDown(e){return this}mouseUp(e){return this.tool.action(),new ee(this.context)}mouseMove(e){return this.tool.bounds.contains(e)?this:new ee(this.context)}}class Nr{constructor(e,s,i){this.context=e,this.startDrag=s,this.handle=i}mouseDown(e){return this}mouseUp(e){return new ee(this.context)}mouseMove(e){return e.distance(this.startDrag)>10?(this.context.view.startDragMessageHandle(this.handle,e.x),new ai(this.context)):this}}class ai{constructor(e){this.context=e}mouseDown(e){return this}mouseUp(e){return this.context.view.finishDragMessageHandle(),new ee(this.context)}mouseMove(e){return this.context.view.updateDragMessageHandle(e.x),this}}class Rr{constructor(e,s,i){this.context=e,this.startDrag=s,this.message=i}mouseDown(e){return this}mouseUp(e){return this.context.view.selectMessage(this.message),new ee(this.context)}mouseMove(e){return e.distance(this.startDrag)>10?new Br(this.context,e,this.message):this}}class Br{constructor(e,s,i){this.context=e,this.dragPoint=s,this.message=i,this.context.view.startDragMessage(i,s.y)}mouseDown(e){return this}mouseUp(e){return this.context.view.finishDragMessage(),this.context.view.selectMessage(this.message),new ee(this.context)}mouseMove(e){return this.context.view.updateDragMessage(e.y),oi(),this}}class Fr{constructor(e,s,i){this.context=e,this.startDrag=s,this.lifeLine=i}mouseDown(e){return this}mouseUp(e){return this.context.view.selectLifeLine(this.lifeLine),new ee(this.context)}mouseMove(e){return e.distance(this.startDrag)>10?new Ir(this.context,e,this.lifeLine):this}}class Ir{constructor(e,s,i){this.context=e,this.dragPoint=s,this.lifeLine=i,this.context.view.startDragLifeLine(this.lifeLine,s.x)}mouseDown(e){return this}mouseUp(e){return this.context.view.finishDragLifeLine(),this.context.view.selectLifeLine(this.lifeLine),new ee(this.context)}mouseMove(e){return this.context.view.updateDragLifeLine(e.x),oi(),this}}function oi(){document.selection?document.selection.empty():window.getSelection().removeAllRanges()}const Ur={lifeLineHeadTextSize:"24px",lifeLineHeadMargin:10,minHeadHeight:60,topMargin:20,leftMargin:20,minHeadGap:20,messageTextSize:"18px",messageStartGap:80,messageGap:60,messageMargin:15},Vr={initialize:t=>{const e=wr(),s=new br(e,Ur,t.measurer,t.svg,n=>t.directEdit.start(n),t.commandStack),i=new Or(s);return{model:e,view:s,state:new ee(i)}},initializeSvg:t=>{t.add("defs").add("marker").id("triangle").viewBox("0 0 10 10").refX("10").refY("5").markerUnits("strokeWidth").markerWidth("10").markerHeight("10").orient("auto-start-reverse").add("path").d("M 0 0 L 10 5 L 0 10 z").fill("black"),t.add("style").content(`
        g.hide {
            visibility: hidden;
        }
        .select-marker {
            stroke: none;
        }
        .select-marker.hover {
            stroke: #55CCFF;
        }
        .select-marker.selected {
            stroke: #55CC99;
        }
        .point-marker {
            fill: none;
        }
        .point-marker.hover {
            fill: #55CCFF;
        }
        .tool rect {
            stroke: #CCCCCC;
        }
        .tool.hover rect {
            stroke: #55CCFF;
        }`)},actions:[{label:"Add LifeLine",run:t=>{t.executeCommand(new fr(t.model,Ct()))}}]};function zr(t){lr(t,{get diagramType(){return Vr}})}Sn(zr,{target:document.body});
